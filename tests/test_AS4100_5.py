from unittest import TestCase
import BeamDesign.Code_Check.AS4100.S5 as S5

Restraints = S5.Restraints


class Test_UT_S5(TestCase):
    """
    This class is a unit test class for the methods in the file S5.py

    These are all bending capacity or shear methods.
    """

    delta_p = 10000  # accept an accuracy of 0.01% in these tests

    def test_s5_2_M_s(self):
        """
        Test the s5_2_M_s method against values calculated in MS Excel.
        """

        section = (
            "45x45x3EA",
            "150x150x12EA",
            "310UC137",
            "75x50x8UA",
            "700WB173",
            "800WB168",
            "400WC181",
            "200x200x26EA",
            "310UB40.4",
            "310UC158",
            "40x40x6EA",
            "1200WB342",
            "180UB18.1",
            "500WC267",
            "200UBP146",
            "65x65x8EA",
            "250UBP62.6",
            "25x25x5EA",
            "300PFC",
            "350WC280",
            "310UC118",
            "125x125x12EA",
            "125x75x12UA",
            "250UB25.7",
            "250UBP84.9",
            "100x100x12EA",
            "65x50x8UA",
            "150PFC",
            "200PFC",
            "250UC72.9",
            "310UC96.8",
            "400WC144",
            "45x45x5EA",
            "400WC328",
            "610UB125",
            "75x75x10EA",
            "200UB18.2",
            "200x200x20EA",
            "65x50x5UA",
            "800WB122",
            "75x50x5UA",
            "100x100x8EA",
            "125TFB",
            "1200WB455",
            "310UB46.2",
            "75x75x6EA",
        )

        Zex = (
            3.19000e-06,
            1.55000e-04,
            2.30000e-03,
            1.70000e-05,
            6.39000e-03,
            6.84000e-03,
            3.41000e-03,
            6.02000e-04,
            6.33000e-04,
            2.68000e-03,
            5.29000e-06,
            1.98000e-02,
            1.57000e-04,
            6.70000e-03,
            1.70000e-03,
            1.92000e-05,
            7.47000e-04,
            1.47000e-06,
            5.64000e-04,
            4.94000e-03,
            1.95000e-03,
            1.09000e-04,
            6.76000e-05,
            3.19000e-04,
            1.07000e-03,
            6.99000e-05,
            1.41000e-05,
            1.29000e-04,
            2.21000e-04,
            9.77000e-04,
            1.55000e-03,
            2.41000e-03,
            5.32000e-06,
            7.10000e-03,
            3.68000e-03,
            3.05000e-05,
            1.80000e-04,
            4.69000e-04,
            7.59000e-06,
            4.34000e-03,
            8.66000e-06,
            4.29000e-05,
            8.03000e-05,
            2.81000e-02,
            7.29000e-04,
            1.84000e-05,
        )

        Zey = (
            1.55000e-06,
            7.23000e-05,
            1.04000e-03,
            5.93000e-06,
            1.06000e-03,
            9.46000e-04,
            1.51000e-03,
            2.67000e-04,
            1.39000e-04,
            1.21000e-03,
            2.33000e-06,
            2.56000e-03,
            3.25000e-05,
            2.97000e-03,
            7.64000e-04,
            8.59000e-06,
            3.18000e-04,
            6.42000e-07,
            7.72000e-05,
            2.45000e-03,
            8.78000e-04,
            4.96000e-05,
            2.03000e-05,
            6.17000e-05,
            4.74000e-04,
            3.11000e-05,
            5.86000e-06,
            3.85000e-05,
            4.45000e-05,
            4.48000e-04,
            6.84000e-04,
            1.07000e-03,
            2.44000e-06,
            3.20000e-03,
            5.15000e-04,
            1.36000e-05,
            3.44000e-05,
            2.14000e-04,
            3.17000e-06,
            4.86000e-04,
            3.02000e-06,
            2.00000e-05,
            1.56000e-05,
            5.00000e-03,
            1.63000e-04,
            8.70000e-06,
        )

        fy = (
            3.20000e08,
            3.00000e08,
            2.80000e08,
            3.20000e08,
            2.80000e08,
            2.80000e08,
            3.00000e08,
            2.80000e08,
            3.20000e08,
            2.80000e08,
            3.20000e08,
            2.80000e08,
            3.20000e08,
            2.80000e08,
            2.80000e08,
            3.20000e08,
            3.20000e08,
            3.20000e08,
            3.40000e08,
            3.60000e08,
            3.40000e08,
            3.40000e08,
            3.40000e08,
            3.60000e08,
            3.40000e08,
            3.40000e08,
            3.60000e08,
            3.60000e08,
            3.40000e08,
            3.40000e08,
            3.40000e08,
            3.80000e08,
            3.60000e08,
            3.60000e08,
            3.40000e08,
            3.60000e08,
            3.60000e08,
            3.40000e08,
            3.60000e08,
            3.80000e08,
            3.60000e08,
            3.60000e08,
            3.60000e08,
            3.60000e08,
            3.40000e08,
            3.60000e08,
        )

        Msx = (
            1.02080e03,
            4.65000e04,
            6.44000e05,
            5.44000e03,
            1.78920e06,
            1.91520e06,
            1.02300e06,
            1.68560e05,
            2.02560e05,
            7.50400e05,
            1.69280e03,
            5.54400e06,
            5.02400e04,
            1.87600e06,
            4.76000e05,
            6.14400e03,
            2.39040e05,
            4.70400e02,
            1.91760e05,
            1.77840e06,
            6.63000e05,
            3.70600e04,
            2.29840e04,
            1.14840e05,
            3.63800e05,
            2.37660e04,
            5.07600e03,
            4.64400e04,
            7.51400e04,
            3.32180e05,
            5.27000e05,
            9.15800e05,
            1.91520e03,
            2.55600e06,
            1.25120e06,
            1.09800e04,
            6.48000e04,
            1.59460e05,
            2.73240e03,
            1.64920e06,
            3.11760e03,
            1.54440e04,
            2.89080e04,
            1.01160e07,
            2.47860e05,
            6.62400e03,
        )

        Msy = (
            4.96000e02,
            2.16900e04,
            2.91200e05,
            1.89760e03,
            2.96800e05,
            2.64880e05,
            4.53000e05,
            7.47600e04,
            4.44800e04,
            3.38800e05,
            7.45600e02,
            7.16800e05,
            1.04000e04,
            8.31600e05,
            2.13920e05,
            2.74880e03,
            1.01760e05,
            2.05440e02,
            2.62480e04,
            8.82000e05,
            2.98520e05,
            1.68640e04,
            6.90200e03,
            2.22120e04,
            1.61160e05,
            1.05740e04,
            2.10960e03,
            1.38600e04,
            1.51300e04,
            1.52320e05,
            2.32560e05,
            4.06600e05,
            8.78400e02,
            1.15200e06,
            1.75100e05,
            4.89600e03,
            1.23840e04,
            7.27600e04,
            1.14120e03,
            1.84680e05,
            1.08720e03,
            7.20000e03,
            5.61600e03,
            1.80000e06,
            5.54200e04,
            3.13200e03,
        )

        for Si, Zexi, Zeyi, fyi, Msxi, Msyi in zip(section, Zex, Zey, fy, Msx, Msy):

            with self.subTest(Si + ", Msx"):
                Mx = S5.s5_2_M_s(f_y=fyi, Z_e=Zexi)

                self.assertAlmostEqual(
                    first=Mx,
                    second=Msxi,
                    delta=Msxi / Test_UT_S5.delta_p,
                    msg="Failed test for Msx, Section was :" + Si,
                )
            with self.subTest(Si + ", Msy"):
                My = S5.s5_2_M_s(f_y=fyi, Z_e=Zeyi)
                self.assertAlmostEqual(
                    first=My,
                    second=Msyi,
                    delta=Msyi / Test_UT_S5.delta_p,
                    msg="Failed test for Msy, Section was :" + Si,
                )

    def test_s5_6_1_M_o(self):
        """
        Test the s5_6_1_M_o method against values calculated in Excel.

        β_x is assumed to be 0.0000
        """

        Section = (
            "45x45x3EA",
            "150x150x12EA",
            "310UC137",
            "75x50x8UA",
            "700WB173",
            "800WB168",
            "400WC181",
            "200x200x26EA",
            "310UB40.4",
            "310UC158",
            "40x40x6EA",
            "1200WB342",
            "180UB18.1",
            "500WC267",
            "200UBP146",
            "65x65x8EA",
            "250UBP62.6",
            "25x25x5EA",
            "300PFC",
            "350WC280",
            "310UC118",
            "125x125x12EA",
            "125x75x12UA",
            "250UB25.7",
            "250UBP84.9",
            "100x100x12EA",
            "65x50x8UA",
            "150PFC",
            "200PFC",
            "250UC72.9",
            "310UC96.8",
            "400WC144",
            "45x45x5EA",
            "400WC328",
            "610UB125",
            "75x75x10EA",
            "200UB18.2",
            "200x200x20EA",
            "65x50x5UA",
            "800WB122",
            "75x50x5UA",
            "100x100x8EA",
            "125TFB",
            "1200WB455",
            "310UB46.2",
            "75x75x6EA",
        )

        le = (
            6.71748e00,
            5.00175e00,
            8.39480e00,
            7.88096e00,
            8.15890e00,
            4.44118e00,
            3.39838e00,
            7.70670e00,
            1.60749e00,
            9.67610e-01,
            4.39861e00,
            3.69312e00,
            8.87880e00,
            2.64963e00,
            9.01857e00,
            5.86595e00,
            1.85971e00,
            3.19589e00,
            9.19554e00,
            2.27102e00,
            1.02159e00,
            9.13501e00,
            7.77546e00,
            3.73183e00,
            7.00531e00,
            6.78814e00,
            7.90351e00,
            1.08615e00,
            9.58450e00,
            5.63679e00,
            2.36882e00,
            1.18624e00,
            7.14942e00,
            9.28371e-01,
            8.31483e00,
            4.03320e00,
            8.68449e00,
            3.60536e00,
            8.10943e00,
            3.04344e00,
            4.53965e00,
            9.00473e00,
            1.05809e00,
            8.29448e00,
            2.88927e00,
            6.17874e00,
        )

        Iy = (
            2.06000e-08,
            3.06000e-06,
            1.07000e-04,
            1.06000e-07,
            9.71000e-05,
            8.67000e-05,
            2.14000e-04,
            1.49000e-05,
            7.65000e-06,
            1.25000e-04,
            2.65000e-08,
            3.42000e-04,
            9.75000e-07,
            5.21000e-04,
            5.55000e-05,
            1.54000e-07,
            2.97000e-05,
            4.69000e-09,
            4.04000e-06,
            2.86000e-04,
            9.02000e-05,
            1.73000e-06,
            5.85000e-07,
            2.55000e-06,
            4.20000e-05,
            8.57000e-07,
            9.36000e-08,
            1.29000e-06,
            1.65000e-06,
            3.88000e-05,
            7.29000e-05,
            1.71000e-04,
            3.03000e-08,
            4.27000e-04,
            3.93000e-05,
            2.82000e-07,
            1.14000e-06,
            1.18000e-05,
            5.87000e-08,
            4.17000e-05,
            6.66000e-08,
            5.82000e-07,
            3.37000e-07,
            8.34000e-04,
            9.01000e-06,
            1.87000e-07,
        )

        J = (
            8.75000e-10,
            1.74000e-07,
            2.52000e-06,
            1.95000e-08,
            4.02000e-06,
            2.99000e-06,
            3.08000e-06,
            2.25000e-06,
            1.57000e-07,
            3.81000e-06,
            5.60000e-09,
            9.96000e-06,
            4.48000e-08,
            6.37000e-06,
            5.98000e-06,
            2.00000e-08,
            3.45000e-07,
            1.66000e-09,
            2.90000e-07,
            1.65000e-05,
            1.63000e-06,
            1.41000e-07,
            1.10000e-07,
            6.74000e-08,
            8.27000e-07,
            1.10000e-07,
            1.76000e-08,
            5.49000e-08,
            1.01000e-07,
            5.86000e-07,
            9.28000e-07,
            1.58000e-06,
            2.96000e-09,
            1.92000e-05,
            1.56000e-06,
            4.19000e-08,
            3.86000e-08,
            1.06000e-06,
            3.87000e-09,
            9.21000e-07,
            4.32000e-09,
            3.17000e-08,
            4.02000e-08,
            2.20000e-05,
            2.33000e-07,
            1.12000e-08,
        )

        Iw = (
            0.00000e00,
            0.00000e00,
            2.39000e-06,
            0.00000e00,
            1.15000e-05,
            1.34000e-05,
            7.31000e-06,
            0.00000e00,
            1.65000e-07,
            2.86000e-06,
            0.00000e00,
            1.13000e-04,
            6.80000e-09,
            2.94000e-05,
            6.30000e-07,
            0.00000e00,
            4.15000e-07,
            0.00000e00,
            5.82000e-08,
            7.10000e-06,
            1.98000e-06,
            0.00000e00,
            0.00000e00,
            3.67000e-08,
            6.03000e-07,
            0.00000e00,
            0.00000e00,
            4.59000e-09,
            1.06000e-08,
            5.57000e-07,
            1.56000e-06,
            5.72000e-06,
            0.00000e00,
            1.62000e-05,
            3.45000e-06,
            0.00000e00,
            1.04000e-08,
            0.00000e00,
            0.00000e00,
            6.28000e-06,
            0.00000e00,
            0.00000e00,
            1.14000e-09,
            2.80000e-04,
            1.97000e-07,
            0.00000e00,
        )

        E = (
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
        )

        G = (
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
        )

        Mo0 = (
            2.51154e02,
            5.79727e04,
            8.97126e05,
            2.29246e03,
            1.38125e06,
            3.70284e06,
            7.39670e06,
            2.98556e05,
            8.99975e05,
            4.08579e07,
            1.10055e03,
            2.91357e07,
            9.57360e03,
            3.58544e07,
            8.15457e05,
            3.75965e03,
            2.11728e06,
            3.46944e02,
            4.81261e04,
            2.10220e07,
            2.57126e07,
            2.14849e04,
            1.29646e04,
            6.18783e04,
            3.90824e05,
            1.79740e04,
            2.04072e03,
            1.61422e05,
            1.71625e04,
            4.43184e05,
            3.99708e06,
            4.42155e07,
            5.26388e02,
            1.94387e08,
            5.00557e05,
            1.07100e04,
            1.00128e04,
            3.89812e05,
            7.38574e02,
            3.54230e06,
            1.48479e03,
            5.99419e03,
            5.57239e04,
            1.53084e07,
            3.72767e05,
            2.94334e03,
        )

        for Si, lei, Iyi, Ji, Iwi, Ei, Gi, Mo0i in zip(
            Section, le, Iy, J, Iw, E, G, Mo0
        ):

            # first check βx = 0

            with self.subTest(Si):
                M = S5.s5_6_1_M_o(l_e=lei, I_y=Iyi, J=Ji, I_w=Iwi, β_x=0.0, E=Ei, G=Gi)

                self.assertAlmostEqual(
                    first=M,
                    second=Mo0i,
                    delta=Mo0i / Test_UT_S5.delta_p,
                    msg="Test of M_o method failed on " + "Section: " + Si,
                )

    def test_s5_6_1_M_o_β_x_rand(self):
        """
        Test the s5_6_1_M_o method against values calculated in Excel.

        Currently β_x is a random number as an accurate means of calculating β_x
        has not yet been implemented.
        """

        # TODO: implement check with accurate values of β_x

        Section = (
            "45x45x3EA",
            "150x150x12EA",
            "310UC137",
            "75x50x8UA",
            "700WB173",
            "800WB168",
            "400WC181",
            "200x200x26EA",
            "310UB40.4",
            "310UC158",
            "40x40x6EA",
            "1200WB342",
            "180UB18.1",
            "500WC267",
            "200UBP146",
            "65x65x8EA",
            "250UBP62.6",
            "25x25x5EA",
            "300PFC",
            "350WC280",
            "310UC118",
            "125x125x12EA",
            "125x75x12UA",
            "250UB25.7",
            "250UBP84.9",
            "100x100x12EA",
            "65x50x8UA",
            "150PFC",
            "200PFC",
            "250UC72.9",
            "310UC96.8",
            "400WC144",
            "45x45x5EA",
            "400WC328",
            "610UB125",
            "75x75x10EA",
            "200UB18.2",
            "200x200x20EA",
            "65x50x5UA",
            "800WB122",
            "75x50x5UA",
            "100x100x8EA",
            "125TFB",
            "1200WB455",
            "310UB46.2",
            "75x75x6EA",
        )

        le = (
            6.71748e00,
            5.00175e00,
            8.39480e00,
            7.88096e00,
            8.15890e00,
            4.44118e00,
            3.39838e00,
            7.70670e00,
            1.60749e00,
            9.67610e-01,
            4.39861e00,
            3.69312e00,
            8.87880e00,
            2.64963e00,
            9.01857e00,
            5.86595e00,
            1.85971e00,
            3.19589e00,
            9.19554e00,
            2.27102e00,
            1.02159e00,
            9.13501e00,
            7.77546e00,
            3.73183e00,
            7.00531e00,
            6.78814e00,
            7.90351e00,
            1.08615e00,
            9.58450e00,
            5.63679e00,
            2.36882e00,
            1.18624e00,
            7.14942e00,
            9.28371e-01,
            8.31483e00,
            4.03320e00,
            8.68449e00,
            3.60536e00,
            8.10943e00,
            3.04344e00,
            4.53965e00,
            9.00473e00,
            1.05809e00,
            8.29448e00,
            2.88927e00,
            6.17874e00,
        )

        Iy = (
            2.06000e-08,
            3.06000e-06,
            1.07000e-04,
            1.06000e-07,
            9.71000e-05,
            8.67000e-05,
            2.14000e-04,
            1.49000e-05,
            7.65000e-06,
            1.25000e-04,
            2.65000e-08,
            3.42000e-04,
            9.75000e-07,
            5.21000e-04,
            5.55000e-05,
            1.54000e-07,
            2.97000e-05,
            4.69000e-09,
            4.04000e-06,
            2.86000e-04,
            9.02000e-05,
            1.73000e-06,
            5.85000e-07,
            2.55000e-06,
            4.20000e-05,
            8.57000e-07,
            9.36000e-08,
            1.29000e-06,
            1.65000e-06,
            3.88000e-05,
            7.29000e-05,
            1.71000e-04,
            3.03000e-08,
            4.27000e-04,
            3.93000e-05,
            2.82000e-07,
            1.14000e-06,
            1.18000e-05,
            5.87000e-08,
            4.17000e-05,
            6.66000e-08,
            5.82000e-07,
            3.37000e-07,
            8.34000e-04,
            9.01000e-06,
            1.87000e-07,
        )

        J = (
            8.75000e-10,
            1.74000e-07,
            2.52000e-06,
            1.95000e-08,
            4.02000e-06,
            2.99000e-06,
            3.08000e-06,
            2.25000e-06,
            1.57000e-07,
            3.81000e-06,
            5.60000e-09,
            9.96000e-06,
            4.48000e-08,
            6.37000e-06,
            5.98000e-06,
            2.00000e-08,
            3.45000e-07,
            1.66000e-09,
            2.90000e-07,
            1.65000e-05,
            1.63000e-06,
            1.41000e-07,
            1.10000e-07,
            6.74000e-08,
            8.27000e-07,
            1.10000e-07,
            1.76000e-08,
            5.49000e-08,
            1.01000e-07,
            5.86000e-07,
            9.28000e-07,
            1.58000e-06,
            2.96000e-09,
            1.92000e-05,
            1.56000e-06,
            4.19000e-08,
            3.86000e-08,
            1.06000e-06,
            3.87000e-09,
            9.21000e-07,
            4.32000e-09,
            3.17000e-08,
            4.02000e-08,
            2.20000e-05,
            2.33000e-07,
            1.12000e-08,
        )

        Iw = (
            0.00000e00,
            0.00000e00,
            2.39000e-06,
            0.00000e00,
            1.15000e-05,
            1.34000e-05,
            7.31000e-06,
            0.00000e00,
            1.65000e-07,
            2.86000e-06,
            0.00000e00,
            1.13000e-04,
            6.80000e-09,
            2.94000e-05,
            6.30000e-07,
            0.00000e00,
            4.15000e-07,
            0.00000e00,
            5.82000e-08,
            7.10000e-06,
            1.98000e-06,
            0.00000e00,
            0.00000e00,
            3.67000e-08,
            6.03000e-07,
            0.00000e00,
            0.00000e00,
            4.59000e-09,
            1.06000e-08,
            5.57000e-07,
            1.56000e-06,
            5.72000e-06,
            0.00000e00,
            1.62000e-05,
            3.45000e-06,
            0.00000e00,
            1.04000e-08,
            0.00000e00,
            0.00000e00,
            6.28000e-06,
            0.00000e00,
            0.00000e00,
            1.14000e-09,
            2.80000e-04,
            1.97000e-07,
            0.00000e00,
        )

        # random values of β_x
        βx = (
            1.28173e-01,
            -1.42314e-01,
            1.78449e-01,
            2.45703e-01,
            -1.48817e-01,
            1.90016e-01,
            -3.08997e-02,
            2.27412e-01,
            -4.31823e-02,
            2.32830e-01,
            7.81551e-02,
            -1.81195e-01,
            -2.03927e-01,
            6.99328e-02,
            -1.73018e-01,
            1.61423e-01,
            -1.78620e-01,
            -1.16781e-01,
            4.82682e-02,
            -1.22808e-01,
            4.07138e-02,
            6.11456e-02,
            2.12952e-01,
            -1.25923e-01,
            -3.82946e-02,
            1.14895e-01,
            -8.74274e-03,
            -1.73450e-01,
            2.35091e-01,
            1.89466e-02,
            1.48394e-01,
            -2.44949e-01,
            1.32684e-01,
            8.93709e-02,
            4.72989e-02,
            -4.30083e-02,
            -1.44619e-01,
            4.54835e-02,
            -1.31337e-01,
            5.14391e-02,
            -1.30045e-01,
            -8.56207e-02,
            -1.38838e-01,
            8.20854e-02,
            1.10207e-01,
            1.86297e-01,
        )

        E = (
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
            2.00000e11,
        )

        G = (
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
            8.00000e10,
        )

        Mo = (
            3.15458e02,
            4.32847e04,
            1.20354e06,
            2.74338e03,
            1.18352e06,
            4.61784e06,
            6.85316e06,
            3.60126e05,
            7.82603e05,
            8.17736e07,
            1.21126e03,
            2.49946e07,
            7.40267e03,
            4.13406e07,
            7.07217e05,
            4.53970e03,
            1.08894e06,
            2.98032e02,
            5.04559e04,
            1.53491e07,
            2.94190e07,
            2.27724e04,
            1.51568e04,
            4.31738e04,
            3.59813e05,
            2.02064e04,
            2.02784e03,
            5.99878e04,
            2.18288e04,
            4.66607e05,
            6.32959e06,
            2.37074e07,
            6.09709e02,
            2.42938e08,
            5.27796e05,
            9.99943e03,
            8.08513e03,
            4.32687e05,
            6.31879e02,
            3.77822e06,
            1.12686e03,
            5.41826e03,
            2.80816e04,
            1.63219e07,
            5.08213e05,
            3.97868e03,
        )

        for Si, lei, Iyi, Ji, Iwi, βxi, Ei, Gi, Moi in zip(
            Section, le, Iy, J, Iw, βx, E, G, Mo
        ):

            with self.subTest(Si):
                M = S5.s5_6_1_M_o(l_e=lei, I_y=Iyi, J=Ji, I_w=Iwi, β_x=βxi, E=Ei, G=Gi)

                self.assertAlmostEqual(
                    first=M,
                    second=Moi,
                    delta=Moi / Test_UT_S5.delta_p,
                    msg="Check of M_o method failed on " + "Section: " + Si + ".",
                )

    def test_s5_6_1_α_m(self):
        """
        Test the s5_6_1_α_m method against values calculated in excel.
        """

        Mmax = (
            4.67469e05,
            3.49510e05,
            3.47664e05,
            2.67263e05,
            2.32884e05,
            3.44566e05,
            2.72960e05,
            1.64726e05,
            2.00472e05,
            4.20864e05,
            4.26130e05,
            4.24465e05,
            4.07899e05,
            2.87867e05,
            4.14763e05,
            2.82995e05,
            4.78969e05,
            4.00384e05,
            9.92535e04,
            1.89387e05,
            4.60724e05,
            4.86889e05,
            2.91128e05,
            3.04559e05,
            4.67600e05,
            3.60335e05,
            4.88652e05,
            4.96792e05,
            3.86504e05,
            4.57667e05,
            4.39645e05,
            3.93075e05,
            9.03782e04,
            3.93286e05,
            4.40849e05,
            3.28920e05,
            4.56775e05,
            4.12964e05,
            4.01556e05,
            4.61276e05,
            4.65965e05,
            4.85649e05,
            2.69758e05,
            2.76627e05,
            4.30286e05,
            4.85566e05,
        )

        M2 = (
            -4.67469e05,
            -1.42941e05,
            3.37893e04,
            -7.93088e04,
            2.32884e05,
            -3.30326e05,
            -2.25569e05,
            1.48658e05,
            1.85336e05,
            2.99774e05,
            -1.66170e05,
            1.84504e05,
            -2.84170e05,
            -2.87867e05,
            -4.14763e05,
            2.78503e05,
            4.78969e05,
            -1.98291e05,
            9.92535e04,
            6.57249e04,
            4.32001e05,
            3.28003e05,
            1.45176e05,
            -3.04559e05,
            -4.43804e05,
            3.60335e05,
            -4.88652e05,
            1.88432e05,
            -3.50844e05,
            4.57667e05,
            -2.79432e05,
            5.63936e04,
            2.85457e04,
            -3.54995e04,
            -2.14387e05,
            1.90845e05,
            4.56775e05,
            -1.89878e05,
            -1.25864e05,
            -1.91055e05,
            3.61256e05,
            -2.80688e05,
            2.69758e05,
            1.45844e05,
            4.93166e04,
            -3.66316e05,
        )

        M3 = (
            3.09832e05,
            3.49510e05,
            3.99423e04,
            -2.67263e05,
            1.52122e05,
            3.44566e05,
            2.72960e05,
            -1.51186e05,
            -2.00472e05,
            2.53132e04,
            -4.26130e05,
            3.75895e04,
            -3.49868e05,
            2.32965e05,
            3.54572e05,
            -2.82995e05,
            -3.35897e05,
            1.65104e05,
            -9.46127e04,
            -1.01430e03,
            -3.45896e05,
            4.86889e05,
            -2.88577e05,
            1.60939e05,
            -3.10001e05,
            2.85896e04,
            -1.60857e05,
            -4.96792e05,
            -2.97685e05,
            -3.55650e04,
            -7.08319e04,
            2.23977e05,
            4.25752e04,
            3.47805e04,
            -4.40849e05,
            3.28920e05,
            -2.31485e05,
            -3.96210e05,
            1.41539e05,
            4.61276e05,
            -1.16695e05,
            4.85649e05,
            4.48760e04,
            2.76627e05,
            3.95937e05,
            -2.52989e05,
        )

        M4 = (
            -3.67540e05,
            -2.72333e05,
            1.34665e05,
            -1.71207e05,
            -8.34585e04,
            5.79356e04,
            -1.69507e05,
            2.33500e04,
            1.35106e05,
            -4.20864e05,
            -3.66534e05,
            -2.40353e05,
            -4.07899e05,
            -1.66892e05,
            -2.31913e05,
            2.20148e04,
            2.34881e05,
            -4.00384e05,
            -4.26201e03,
            1.89387e05,
            4.60724e05,
            -1.27297e05,
            2.91128e05,
            -6.42444e04,
            4.27759e05,
            3.94525e04,
            -1.33635e05,
            -2.18382e05,
            -3.86504e05,
            -2.24250e05,
            -2.46608e05,
            3.93075e05,
            9.03782e04,
            -1.49941e05,
            1.65647e05,
            2.32781e05,
            4.25411e05,
            -4.12964e05,
            -3.64551e05,
            -4.44435e05,
            1.87597e05,
            -2.29443e05,
            2.53479e05,
            -1.23990e05,
            -4.30286e05,
            3.05971e05,
        )

        αm_max = (
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
            2.50000e00,
        )

        αm = (
            1.18518e00,
            1.27622e00,
            2.50000e00,
            1.38878e00,
            1.36323e00,
            1.21823e00,
            1.18200e00,
            1.31280e00,
            1.11879e00,
            1.38300e00,
            1.23594e00,
            2.36334e00,
            1.14069e00,
            1.20478e00,
            1.18923e00,
            1.20980e00,
            1.29163e00,
            1.42896e00,
            1.22991e00,
            1.60601e00,
            1.08768e00,
            1.37789e00,
            1.13809e00,
            1.47757e00,
            1.15213e00,
            1.68467e00,
            1.56289e00,
            1.47017e00,
            1.09344e00,
            1.52289e00,
            1.97015e00,
            1.46570e00,
            1.47872e00,
            2.50000e00,
            1.44836e00,
            1.25411e00,
            1.16641e00,
            1.16430e00,
            1.66167e00,
            1.17315e00,
            1.87065e00,
            1.36229e00,
            1.22988e00,
            1.39793e00,
            1.24655e00,
            1.52809e00,
        )

        for i, v in enumerate(zip(Mmax, M2, M3, M4, αm_max, αm)):

            Mmi, M2i, M3i, M4i, αmmi, αmi = v

            with self.subTest(i):
                αm_calc = S5.s5_6_1_α_m(
                    M_max=Mmi, M_2=M2i, M_3=M3i, M_4=M4i, α_m_max=αmmi
                )

                self.assertAlmostEqual(
                    first=αm_calc, second=αmi, delta=αmi / Test_UT_S5.delta_p
                )

    def test_s5_6_α_s(self):
        """
        Test the s5_6_α_s method against values calculated in Excel.
        """

        Section = (
            "45x45x3EA",
            "150x150x12EA",
            "310UC137",
            "75x50x8UA",
            "700WB173",
            "800WB168",
            "400WC181",
            "200x200x26EA",
            "310UB40.4",
            "310UC158",
            "40x40x6EA",
            "1200WB342",
            "180UB18.1",
            "500WC267",
            "200UBP146",
            "65x65x8EA",
            "250UBP62.6",
            "25x25x5EA",
            "300PFC",
            "350WC280",
            "310UC118",
            "125x125x12EA",
            "125x75x12UA",
            "250UB25.7",
            "250UBP84.9",
            "100x100x12EA",
            "65x50x8UA",
            "150PFC",
            "200PFC",
            "250UC72.9",
            "310UC96.8",
            "400WC144",
            "45x45x5EA",
            "400WC328",
            "610UB125",
            "75x75x10EA",
            "200UB18.2",
            "200x200x20EA",
            "65x50x5UA",
            "800WB122",
            "75x50x5UA",
            "100x100x8EA",
            "125TFB",
            "1200WB455",
            "310UB46.2",
            "75x75x6EA",
        )

        Mo = (
            3.15458e02,
            4.32847e04,
            1.20354e06,
            2.74338e03,
            1.18352e06,
            4.61784e06,
            6.85316e06,
            3.60126e05,
            7.82603e05,
            8.17736e07,
            1.21126e03,
            2.49946e07,
            7.40267e03,
            4.13406e07,
            7.07217e05,
            4.53970e03,
            1.08894e06,
            2.98032e02,
            5.04559e04,
            1.53491e07,
            2.94190e07,
            2.27724e04,
            1.51568e04,
            4.31738e04,
            3.59813e05,
            2.02064e04,
            2.02784e03,
            5.99878e04,
            2.18288e04,
            4.66607e05,
            6.32959e06,
            2.37074e07,
            6.09709e02,
            2.42938e08,
            5.27796e05,
            9.99943e03,
            8.08513e03,
            4.32687e05,
            6.31879e02,
            3.77822e06,
            1.12686e03,
            5.41826e03,
            2.80816e04,
            1.63219e07,
            5.08213e05,
            3.97868e03,
        )

        Ms = (
            1.02080e03,
            4.65000e04,
            6.44000e05,
            5.44000e03,
            1.78920e06,
            1.91520e06,
            1.02300e06,
            1.68560e05,
            2.02560e05,
            7.50400e05,
            1.69280e03,
            5.54400e06,
            5.02400e04,
            1.87600e06,
            4.76000e05,
            6.14400e03,
            2.39040e05,
            4.70400e02,
            1.91760e05,
            1.77840e06,
            6.63000e05,
            3.70600e04,
            2.29840e04,
            1.14840e05,
            3.63800e05,
            2.37660e04,
            5.07600e03,
            4.64400e04,
            7.51400e04,
            3.32180e05,
            5.27000e05,
            9.15800e05,
            1.91520e03,
            2.55600e06,
            1.25120e06,
            1.09800e04,
            6.48000e04,
            1.59460e05,
            2.73240e03,
            1.64920e06,
            3.11760e03,
            1.54440e04,
            2.89080e04,
            1.01160e07,
            2.47860e05,
            6.62400e03,
        )

        αs = (
            2.60634e-01,
            5.78325e-01,
            7.66640e-01,
            3.89961e-01,
            4.72346e-01,
            8.19764e-01,
            9.53518e-01,
            7.95673e-01,
            8.95473e-01,
            1.03374e00,
            4.96810e-01,
            9.14632e-01,
            1.30520e-01,
            1.01236e00,
            7.11100e-01,
            5.06828e-01,
            9.15833e-01,
            4.58986e-01,
            2.25644e-01,
            9.72035e-01,
            1.02580e00,
            4.49544e-01,
            4.71391e-01,
            3.08530e-01,
            5.96690e-01,
            5.50490e-01,
            3.24491e-01,
            6.73818e-01,
            2.46721e-01,
            6.96445e-01,
            9.90475e-01,
            1.01631e00,
            2.67530e-01,
            1.03294e00,
            3.39203e-01,
            5.71637e-01,
            1.11012e-01,
            8.41374e-01,
            2.00390e-01,
            8.09823e-01,
            2.98472e-01,
            2.90993e-01,
            5.91268e-01,
            7.31892e-01,
            7.87018e-01,
            4.42550e-01,
        )

        for Si, Moi, Msi, αsi in zip(Section, Mo, Ms, αs):

            with self.subTest(Si):
                αs_calc = S5.s5_6_α_s(M_s=Msi, M_o=Moi)

                self.assertAlmostEqual(
                    first=αs_calc, second=αsi, delta=αsi / Test_UT_S5.delta_p
                )

    def test_s5_6_3_k_t(self):
        """
        Test the s5_6_3_k_t method against values calculated in Excel.

        Note that to check the effect of multiple webs a random no. of webs has
        been chosen and applied to section properties taken from I sections,
        not from real hollow sections.
        """

        Section = (
            "310UC137",
            "700WB173",
            "800WB168",
            "400WC181",
            "310UB40.4",
            "310UC158",
            "1200WB342",
            "180UB18.1",
            "500WC267",
            "200UBP146",
            "250UBP62.6",
            "300PFC",
            "350WC280",
            "310UC118",
            "250UB25.7",
            "250UBP84.9",
            "150PFC",
            "200PFC",
            "250UC72.9",
            "310UC96.8",
            "400WC144",
            "400WC328",
            "610UB125",
            "200UB18.2",
            "800WB122",
            "125TFB",
            "1200WB455",
            "310UB46.2",
            "200UC46.2",
            "250UB31.4",
            "500WC340",
            "460UB82.1",
            "100TFB",
            "250UC89.5",
            "460UB74.6",
            "100PFC",
            "250UB37.3",
            "400WC212",
            "180UB16.1",
            "1200WB249",
            "360UB44.7",
            "350WC258",
            "310UC137",
            "700WB173",
            "800WB168",
            "400WC181",
            "310UB40.4",
            "310UC158",
            "180UB18.1",
            "500WC267",
            "200UBP146",
            "250UBP62.6",
            "300PFC",
            "350WC280",
            "310UC118",
            "250UBP84.9",
            "150PFC",
            "200PFC",
            "250UC72.9",
            "310UC96.8",
            "400WC144",
            "610UB125",
            "200UB18.2",
            "800WB122",
            "125TFB",
            "1200WB455",
            "310UB46.2",
            "200UC46.2",
            "250UB31.4",
            "500WC340",
            "100TFB",
            "250UC89.5",
            "460UB74.6",
            "100PFC",
            "250UB37.3",
            "400WC212",
            "180UB16.1",
            "1200WB249",
            "150UB14.0",
            "350WC258",
        )

        Restraint = (
            "PL",
            "PL",
            "FP",
            "FP",
            "FF",
            "PU",
            "PP",
            "PP",
            "PP",
            "FF",
            "LL",
            "PL",
            "FF",
            "PL",
            "PL",
            "PL",
            "FU",
            "PU",
            "FP",
            "LL",
            "FL",
            "FP",
            "PL",
            "LL",
            "FU",
            "FL",
            "FL",
            "PL",
            "PL",
            "PL",
            "FU",
            "PP",
            "FF",
            "FP",
            "PL",
            "LL",
            "FF",
            "PU",
            "PU",
            "FP",
            "PP",
            "LL",
            "PL",
            "PL",
            "FP",
            "FP",
            "FF",
            "PU",
            "PP",
            "PP",
            "FF",
            "LL",
            "PL",
            "FF",
            "PL",
            "PL",
            "FU",
            "PU",
            "FP",
            "LL",
            "FL",
            "PL",
            "LL",
            "FU",
            "FL",
            "FL",
            "PL",
            "PL",
            "PL",
            "FU",
            "FF",
            "FP",
            "PL",
            "LL",
            "FF",
            "PU",
            "PU",
            "FP",
            "LL",
            "LL",
        )

        d1 = (
            2.776e-01,
            6.600e-01,
            7.600e-01,
            3.500e-01,
            2.836e-01,
            2.770e-01,
            1.120e00,
            1.590e-01,
            4.500e-01,
            1.810e-01,
            2.258e-01,
            2.680e-01,
            2.750e-01,
            2.776e-01,
            2.320e-01,
            2.254e-01,
            1.310e-01,
            1.760e-01,
            2.256e-01,
            2.772e-01,
            3.500e-01,
            3.500e-01,
            5.728e-01,
            1.840e-01,
            7.600e-01,
            1.080e-01,
            1.120e00,
            2.834e-01,
            1.810e-01,
            2.348e-01,
            4.500e-01,
            4.280e-01,
            8.800e-02,
            2.254e-01,
            4.280e-01,
            8.660e-02,
            2.342e-01,
            3.500e-01,
            1.590e-01,
            1.120e00,
            3.326e-01,
            2.750e-01,
            2.776e-01,
            6.600e-01,
            7.600e-01,
            3.500e-01,
            2.836e-01,
            2.770e-01,
            1.590e-01,
            4.500e-01,
            1.810e-01,
            2.258e-01,
            2.680e-01,
            2.750e-01,
            2.776e-01,
            2.254e-01,
            1.310e-01,
            1.760e-01,
            2.256e-01,
            2.772e-01,
            3.500e-01,
            5.728e-01,
            1.840e-01,
            7.600e-01,
            1.080e-01,
            1.120e00,
            2.834e-01,
            1.810e-01,
            2.348e-01,
            4.500e-01,
            8.800e-02,
            2.254e-01,
            4.280e-01,
            8.660e-02,
            2.342e-01,
            3.500e-01,
            1.590e-01,
            1.120e00,
            1.360e-01,
            2.750e-01,
        )

        l = (
            2.130e00,
            6.738e00,
            2.000e00,
            8.852e00,
            6.465e00,
            4.929e00,
            3.466e00,
            4.726e00,
            7.918e-01,
            4.955e00,
            9.534e-01,
            2.401e00,
            8.997e00,
            4.374e00,
            4.472e00,
            9.118e00,
            5.871e00,
            5.614e00,
            5.843e00,
            4.930e00,
            7.537e00,
            7.459e00,
            8.461e-01,
            3.416e-01,
            5.972e00,
            1.049e00,
            5.348e00,
            6.745e00,
            4.671e00,
            1.961e00,
            2.604e-01,
            9.017e00,
            2.931e00,
            5.898e00,
            7.874e00,
            8.199e00,
            4.505e00,
            2.296e00,
            3.582e-01,
            3.598e00,
            1.825e00,
            2.740e00,
            2.130e00,
            6.738e00,
            2.000e00,
            8.852e00,
            6.465e00,
            4.929e00,
            4.726e00,
            7.918e-01,
            4.955e00,
            9.534e-01,
            2.401e00,
            8.997e00,
            4.374e00,
            9.118e00,
            5.871e00,
            5.614e00,
            5.843e00,
            4.930e00,
            7.537e00,
            8.461e-01,
            3.416e-01,
            5.972e00,
            1.049e00,
            5.348e00,
            6.745e00,
            4.671e00,
            1.961e00,
            2.604e-01,
            2.931e00,
            5.898e00,
            7.874e00,
            8.199e00,
            4.505e00,
            2.296e00,
            3.582e-01,
            3.598e00,
            8.026e00,
            2.740e00,
        )

        tf = (
            2.170e-02,
            2.800e-02,
            2.500e-02,
            2.000e-02,
            1.020e-02,
            2.500e-02,
            3.200e-02,
            8.000e-03,
            2.500e-02,
            3.200e-02,
            1.060e-02,
            1.600e-02,
            4.000e-02,
            1.870e-02,
            8.000e-03,
            1.430e-02,
            9.500e-03,
            1.200e-02,
            1.420e-02,
            1.540e-02,
            1.600e-02,
            4.000e-02,
            1.960e-02,
            7.000e-03,
            1.600e-02,
            8.500e-03,
            4.000e-02,
            1.180e-02,
            1.100e-02,
            8.600e-03,
            3.200e-02,
            1.600e-02,
            6.000e-03,
            1.730e-02,
            1.450e-02,
            6.700e-03,
            1.090e-02,
            2.500e-02,
            7.000e-03,
            2.500e-02,
            9.700e-03,
            3.600e-02,
            2.170e-02,
            2.800e-02,
            2.500e-02,
            2.000e-02,
            1.020e-02,
            2.500e-02,
            8.000e-03,
            2.500e-02,
            3.200e-02,
            1.060e-02,
            1.600e-02,
            4.000e-02,
            1.870e-02,
            1.430e-02,
            9.500e-03,
            1.200e-02,
            1.420e-02,
            1.540e-02,
            1.600e-02,
            1.960e-02,
            7.000e-03,
            1.600e-02,
            8.500e-03,
            4.000e-02,
            1.180e-02,
            1.100e-02,
            8.600e-03,
            3.200e-02,
            6.000e-03,
            1.730e-02,
            1.450e-02,
            6.700e-03,
            1.090e-02,
            2.500e-02,
            7.000e-03,
            2.500e-02,
            7.000e-03,
            3.600e-02,
        )

        tw = (
            1.380e-02,
            1.000e-02,
            1.000e-02,
            2.000e-02,
            6.100e-03,
            1.570e-02,
            1.600e-02,
            5.000e-03,
            2.000e-02,
            2.500e-02,
            1.060e-02,
            8.000e-03,
            2.800e-02,
            1.190e-02,
            5.000e-03,
            1.430e-02,
            6.000e-03,
            6.000e-03,
            8.600e-03,
            9.900e-03,
            1.600e-02,
            2.800e-02,
            1.190e-02,
            4.500e-03,
            1.000e-02,
            5.000e-03,
            1.600e-02,
            6.700e-03,
            7.300e-03,
            6.100e-03,
            2.500e-02,
            9.900e-03,
            4.000e-03,
            1.050e-02,
            9.100e-03,
            4.200e-03,
            6.400e-03,
            2.000e-02,
            4.500e-03,
            1.600e-02,
            6.900e-03,
            2.800e-02,
            1.380e-02,
            1.000e-02,
            1.000e-02,
            2.000e-02,
            6.100e-03,
            1.570e-02,
            5.000e-03,
            2.000e-02,
            2.500e-02,
            1.060e-02,
            8.000e-03,
            2.800e-02,
            1.190e-02,
            1.430e-02,
            6.000e-03,
            6.000e-03,
            8.600e-03,
            9.900e-03,
            1.600e-02,
            1.190e-02,
            4.500e-03,
            1.000e-02,
            5.000e-03,
            1.600e-02,
            6.700e-03,
            7.300e-03,
            6.100e-03,
            2.500e-02,
            4.000e-03,
            1.050e-02,
            9.100e-03,
            4.200e-03,
            6.400e-03,
            2.000e-02,
            4.500e-03,
            1.600e-02,
            5.000e-03,
            2.800e-02,
        )

        nw = (
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            1,
            3,
            1,
            2,
            1,
            2,
            3,
            3,
            3,
            3,
            1,
            3,
            3,
            2,
            3,
            2,
            3,
            1,
            1,
            1,
            2,
            2,
            1,
            3,
            2,
            1,
            3,
            3,
            3,
            1,
            2,
            2,
            2,
            1,
            3,
            1,
            1,
            3,
            3,
        )

        kt = (
            1.06333e0,
            1.26878e0,
            1.74204e0,
            1.00494e0,
            1.00000e0,
            1.02836e0,
            1.64627e0,
            1.03445e0,
            1.27751e0,
            1.00000e0,
            1.00000e0,
            1.11161e0,
            1.00000e0,
            1.03078e0,
            1.02656e0,
            1.00309e0,
            1.00000e0,
            1.03135e0,
            1.02173e0,
            1.00000e0,
            1.00000e0,
            1.01710e0,
            1.37812e0,
            1.00000e0,
            1.00000e0,
            1.00000e0,
            1.00000e0,
            1.02869e0,
            1.01657e0,
            1.04194e0,
            1.00000e0,
            1.05009e0,
            1.00000e0,
            1.02137e0,
            1.02749e0,
            1.00000e0,
            1.00000e0,
            1.03722e0,
            1.20887e0,
            1.14845e0,
            1.12661e0,
            1.00000e0,
            1.02111e0,
            1.26878e0,
            1.37102e0,
            1.00494e0,
            1.00000e0,
            1.00945e0,
            1.01148e0,
            1.09250e0,
            1.00000e0,
            1.00000e0,
            1.03720e0,
            1.00000e0,
            1.01539e0,
            1.00103e0,
            1.00000e0,
            1.01045e0,
            1.02173e0,
            1.00000e0,
            1.00000e0,
            1.18906e0,
            1.00000e0,
            1.00000e0,
            1.00000e0,
            1.00000e0,
            1.02869e0,
            1.00552e0,
            1.01398e0,
            1.00000e0,
            1.00000e0,
            1.01068e0,
            1.01374e0,
            1.00000e0,
            1.00000e0,
            1.01241e0,
            1.20887e0,
            1.14845e0,
            1.00000e0,
            1.00000e0,
        )

        for Si, Ri, d1i, li, tfi, twi, nwi, kti in zip(
            Section, Restraint, d1, l, tf, tw, nw, kt
        ):

            with self.subTest(Si):

                r = Restraints(Ri)
                kt_calc = S5.s5_6_3_k_t(
                    d_1=d1i, l=li, t_f=tfi, t_w=twi, n_w=nwi, restraint_code=r
                )

                self.assertAlmostEqual(
                    first=kt_calc,
                    second=kti,
                    delta=kti / Test_UT_S5.delta_p,
                    msg="Test for k_t failed with Section: "
                    + Si
                    + " and n_w: "
                    + str(nwi),
                )

    def test_s5_6_3_l_e(self):
        """
        Test the s5_6_3_l_e method against values calculated in Excel.
        """

        Section = (
            "310UC137",
            "700WB173",
            "800WB168",
            "400WC181",
            "310UB40.4",
            "310UC158",
            "1200WB342",
            "180UB18.1",
            "500WC267",
            "200UBP146",
            "250UBP62.6",
            "300PFC",
            "350WC280",
            "310UC118",
            "250UB25.7",
            "250UBP84.9",
            "150PFC",
            "200PFC",
            "250UC72.9",
            "310UC96.8",
            "400WC144",
            "400WC328",
            "610UB125",
            "200UB18.2",
            "800WB122",
            "125TFB",
            "1200WB455",
            "310UB46.2",
            "200UC46.2",
            "250UB31.4",
            "500WC340",
            "460UB82.1",
            "100TFB",
            "250UC89.5",
            "460UB74.6",
            "100PFC",
            "250UB37.3",
            "400WC212",
            "180UB16.1",
            "1200WB249",
            "360UB44.7",
            "350WC258",
            "310UC137",
            "700WB173",
            "800WB168",
            "400WC181",
            "310UB40.4",
            "310UC158",
            "180UB18.1",
            "500WC267",
            "200UBP146",
            "250UBP62.6",
            "300PFC",
            "350WC280",
            "310UC118",
            "250UBP84.9",
            "150PFC",
            "200PFC",
            "250UC72.9",
            "310UC96.8",
            "400WC144",
            "610UB125",
            "200UB18.2",
            "800WB122",
            "125TFB",
            "1200WB455",
            "310UB46.2",
            "200UC46.2",
            "250UB31.4",
            "500WC340",
            "100TFB",
            "250UC89.5",
            "460UB74.6",
            "100PFC",
            "250UB37.3",
            "400WC212",
            "180UB16.1",
            "1200WB249",
            "150UB14.0",
            "350WC258",
        )

        l = (
            2.13034e0,
            6.73795e0,
            2.00041e0,
            8.85161e0,
            6.46465e0,
            4.92936e0,
            3.46603e0,
            4.72563e0,
            7.91790e-1,
            4.95495e0,
            9.53414e-1,
            2.40115e0,
            8.99675e0,
            4.37433e0,
            4.47163e0,
            9.11840e0,
            5.87125e0,
            5.61425e0,
            5.84314e0,
            4.93005e0,
            7.53731e0,
            7.45913e0,
            8.46077e-1,
            3.41592e-1,
            5.97192e0,
            1.04903e0,
            5.34757e0,
            6.74515e0,
            4.67074e0,
            1.96118e0,
            2.60397e-1,
            9.01746e0,
            2.93118e0,
            5.89788e0,
            7.87351e0,
            8.19891e0,
            4.50496e0,
            2.29588e0,
            3.58172e-1,
            3.59750e0,
            1.82458e0,
            2.73999e0,
            2.13034e0,
            6.73795e0,
            2.00041e0,
            8.85161e0,
            6.46465e0,
            4.92936e0,
            4.72563e0,
            7.91790e-1,
            4.95495e0,
            9.53414e-1,
            2.40115e0,
            8.99675e0,
            4.37433e0,
            9.11840e0,
            5.87125e0,
            5.61425e0,
            5.84314e0,
            4.93005e0,
            7.53731e0,
            8.46077e-1,
            3.41592e-1,
            5.97192e0,
            1.04903e0,
            5.34757e0,
            6.74515e0,
            4.67074e0,
            1.96118e0,
            2.60397e-1,
            2.93118e0,
            5.89788e0,
            7.87351e0,
            8.19891e0,
            4.50496e0,
            2.29588e0,
            3.58172e-1,
            3.59750e0,
            8.02550e0,
            2.73999e0,
        )

        kt = (
            1.0633e0,
            1.2688e0,
            1.7420e0,
            1.0049e0,
            1.0000e0,
            1.0284e0,
            1.6463e0,
            1.0345e0,
            1.2775e0,
            1.0000e0,
            1.0000e0,
            1.1116e0,
            1.0000e0,
            1.0308e0,
            1.0266e0,
            1.0031e0,
            1.0000e0,
            1.0313e0,
            1.0217e0,
            1.0000e0,
            1.0000e0,
            1.0171e0,
            1.3781e0,
            1.0000e0,
            1.0000e0,
            1.0000e0,
            1.0000e0,
            1.0287e0,
            1.0166e0,
            1.0419e0,
            1.0000e0,
            1.0501e0,
            1.0000e0,
            1.0214e0,
            1.0275e0,
            1.0000e0,
            1.0000e0,
            1.0372e0,
            1.2089e0,
            1.1485e0,
            1.1266e0,
            1.0000e0,
            1.0211e0,
            1.2688e0,
            1.3710e0,
            1.0049e0,
            1.0000e0,
            1.0095e0,
            1.0115e0,
            1.0925e0,
            1.0000e0,
            1.0000e0,
            1.0372e0,
            1.0000e0,
            1.0154e0,
            1.0010e0,
            1.0000e0,
            1.0104e0,
            1.0217e0,
            1.0000e0,
            1.0000e0,
            1.1891e0,
            1.0000e0,
            1.0000e0,
            1.0000e0,
            1.0000e0,
            1.0287e0,
            1.0055e0,
            1.0140e0,
            1.0000e0,
            1.0000e0,
            1.0107e0,
            1.0137e0,
            1.0000e0,
            1.0000e0,
            1.0124e0,
            1.2089e0,
            1.1485e0,
            1.0000e0,
            1.0000e0,
        )

        kl = (
            1.0000e0,
            2.0000e0,
            1.4000e0,
            2.0000e0,
            1.4000e0,
            2.0000e0,
            1.4000e0,
            1.4000e0,
            2.0000e0,
            2.0000e0,
            1.0000e0,
            1.4000e0,
            2.0000e0,
            2.0000e0,
            2.0000e0,
            1.4000e0,
            2.0000e0,
            2.0000e0,
            1.0000e0,
            1.4000e0,
            2.0000e0,
            1.4000e0,
            1.4000e0,
            1.0000e0,
            1.0000e0,
            1.4000e0,
            2.0000e0,
            1.0000e0,
            2.0000e0,
            2.0000e0,
            1.0000e0,
            1.0000e0,
            1.4000e0,
            1.0000e0,
            1.4000e0,
            1.4000e0,
            1.0000e0,
            2.0000e0,
            1.4000e0,
            1.4000e0,
            2.0000e0,
            1.0000e0,
            1.4000e0,
            1.4000e0,
            2.0000e0,
            2.0000e0,
            1.4000e0,
            1.0000e0,
            1.0000e0,
            1.4000e0,
            1.4000e0,
            1.0000e0,
            2.0000e0,
            1.4000e0,
            1.4000e0,
            2.0000e0,
            2.0000e0,
            1.0000e0,
            2.0000e0,
            1.0000e0,
            2.0000e0,
            2.0000e0,
            1.0000e0,
            1.4000e0,
            2.0000e0,
            1.4000e0,
            1.0000e0,
            1.0000e0,
            1.0000e0,
            1.4000e0,
            2.0000e0,
            1.4000e0,
            1.4000e0,
            2.0000e0,
            1.4000e0,
            2.0000e0,
            1.4000e0,
            1.0000e0,
            2.0000e0,
            1.0000e0,
        )

        kr = (
            1.0000e0,
            1.0000e0,
            8.5000e-1,
            1.0000e0,
            8.5000e-1,
            8.5000e-1,
            8.5000e-1,
            8.5000e-1,
            8.5000e-1,
            7.0000e-1,
            1.0000e0,
            8.5000e-1,
            1.0000e0,
            8.5000e-1,
            8.5000e-1,
            7.0000e-1,
            8.5000e-1,
            8.5000e-1,
            1.0000e0,
            8.5000e-1,
            1.0000e0,
            8.5000e-1,
            7.0000e-1,
            1.0000e0,
            1.0000e0,
            7.0000e-1,
            8.5000e-1,
            8.5000e-1,
            8.5000e-1,
            8.5000e-1,
            7.0000e-1,
            8.5000e-1,
            8.5000e-1,
            8.5000e-1,
            8.5000e-1,
            7.0000e-1,
            8.5000e-1,
            1.0000e0,
            7.0000e-1,
            7.0000e-1,
            7.0000e-1,
            1.0000e0,
            8.5000e-1,
            7.0000e-1,
            1.0000e0,
            1.0000e0,
            8.5000e-1,
            1.0000e0,
            8.5000e-1,
            8.5000e-1,
            1.0000e0,
            7.0000e-1,
            7.0000e-1,
            7.0000e-1,
            1.0000e0,
            1.0000e0,
            8.5000e-1,
            1.0000e0,
            8.5000e-1,
            8.5000e-1,
            1.0000e0,
            1.0000e0,
            7.0000e-1,
            8.5000e-1,
            1.0000e0,
            8.5000e-1,
            7.0000e-1,
            1.0000e0,
            8.5000e-1,
            7.0000e-1,
            8.5000e-1,
            7.0000e-1,
            7.0000e-1,
            7.0000e-1,
            1.0000e0,
            1.0000e0,
            1.0000e0,
            1.0000e0,
            1.0000e0,
            1.0000e0,
        )

        le = (
            2.26526e0,
            1.70980e1,
            4.14690e0,
            1.77907e1,
            7.69293e0,
            8.61758e0,
            6.79017e0,
            5.81725e0,
            1.71958e0,
            6.93692e0,
            9.53414e-1,
            3.17628e0,
            1.79935e1,
            7.66528e0,
            7.80370e0,
            8.96364e0,
            9.98113e0,
            9.84343e0,
            5.97008e0,
            5.86676e0,
            1.50746e1,
            9.02815e0,
            1.14268e0,
            3.41592e-1,
            5.97192e0,
            1.02805e0,
            9.09087e0,
            5.89787e0,
            8.07186e0,
            3.47383e0,
            1.82278e-1,
            8.04877e0,
            3.48810e0,
            5.12031e0,
            9.62704e0,
            8.03494e0,
            3.82922e0,
            4.76266e0,
            4.24323e-1,
            4.04893e0,
            2.87782e0,
            2.73999e0,
            2.58863e0,
            8.37801e0,
            5.48520e0,
            1.77907e1,
            7.69293e0,
            4.97596e0,
            4.06291e0,
            1.02939e0,
            6.93692e0,
            6.67390e-1,
            3.48667e0,
            8.81682e0,
            6.21833e0,
            1.82556e1,
            9.98113e0,
            5.67292e0,
            1.01491e1,
            4.19054e0,
            1.50746e1,
            2.01207e0,
            2.39114e-1,
            7.10659e0,
            2.09806e0,
            6.36361e0,
            4.85707e0,
            4.69655e0,
            1.69031e0,
            2.55189e-1,
            4.98300e0,
            5.84167e0,
            7.82210e0,
            1.14785e1,
            6.30695e0,
            4.64873e0,
            6.06176e-1,
            4.13156e0,
            1.60510e1,
            2.73999e0,
        )

        for Si, li, kti, kli, kri, lei in zip(Section, l, kt, kl, kr, le):

            with self.subTest(Si):
                le_calc = S5.s5_6_3_l_e(k_t=kti, k_l=kli, k_r=kri, l_act=li)

                self.assertAlmostEqual(
                    first=le_calc, second=lei, delta=lei / Test_UT_S5.delta_p
                )

    def test_s5_6_1_Mb(self):
        """
        Test the s5_6_1_Mb method against values calculated in Excel.
        """

        Section = (
            "45x45x3EA",
            "150x150x12EA",
            "310UC137",
            "75x50x8UA",
            "700WB173",
            "800WB168",
            "400WC181",
            "200x200x26EA",
            "310UB40.4",
            "310UC158",
            "40x40x6EA",
            "1200WB342",
            "180UB18.1",
            "500WC267",
            "200UBP146",
            "65x65x8EA",
            "250UBP62.6",
            "25x25x5EA",
            "300PFC",
            "350WC280",
            "310UC118",
            "125x125x12EA",
            "125x75x12UA",
            "250UB25.7",
            "250UBP84.9",
            "100x100x12EA",
            "65x50x8UA",
            "150PFC",
            "200PFC",
            "250UC72.9",
            "310UC96.8",
            "400WC144",
            "45x45x5EA",
            "400WC328",
            "610UB125",
            "75x75x10EA",
            "200UB18.2",
            "200x200x20EA",
            "65x50x5UA",
            "800WB122",
            "75x50x5UA",
            "100x100x8EA",
            "125TFB",
            "1200WB455",
            "310UB46.2",
            "75x75x6EA",
        )

        αs = (
            2.60634e-01,
            5.78325e-01,
            7.66640e-01,
            3.89961e-01,
            4.72346e-01,
            8.19764e-01,
            9.53518e-01,
            7.95673e-01,
            8.95473e-01,
            1.03374e00,
            4.96810e-01,
            9.14632e-01,
            1.30520e-01,
            1.01236e00,
            7.11100e-01,
            5.06828e-01,
            9.15833e-01,
            4.58986e-01,
            2.25644e-01,
            9.72035e-01,
            1.02580e00,
            4.49544e-01,
            4.71391e-01,
            3.08530e-01,
            5.96690e-01,
            5.50490e-01,
            3.24491e-01,
            6.73818e-01,
            2.46721e-01,
            6.96445e-01,
            9.90475e-01,
            1.01631e00,
            2.67530e-01,
            1.03294e00,
            3.39203e-01,
            5.71637e-01,
            1.11012e-01,
            8.41374e-01,
            2.00390e-01,
            8.09823e-01,
            2.98472e-01,
            2.90993e-01,
            5.91268e-01,
            7.31892e-01,
            7.87018e-01,
            4.42550e-01,
        )

        αm = (
            1.18518e00,
            1.27622e00,
            2.50000e00,
            1.38878e00,
            1.36323e00,
            1.21823e00,
            1.18200e00,
            1.31280e00,
            1.11879e00,
            1.38300e00,
            1.23594e00,
            2.36334e00,
            1.14069e00,
            1.20478e00,
            1.18923e00,
            1.20980e00,
            1.29163e00,
            1.42896e00,
            1.22991e00,
            1.60601e00,
            1.08768e00,
            1.37789e00,
            1.13809e00,
            1.47757e00,
            1.15213e00,
            1.68467e00,
            1.56289e00,
            1.47017e00,
            1.09344e00,
            1.52289e00,
            1.97015e00,
            1.46570e00,
            1.47872e00,
            2.50000e00,
            1.44836e00,
            1.25411e00,
            1.16641e00,
            1.16430e00,
            1.66167e00,
            1.17315e00,
            1.87065e00,
            1.36229e00,
            1.22988e00,
            1.39793e00,
            1.24655e00,
            1.52809e00,
        )

        Ms = (
            1.02080e03,
            4.65000e04,
            6.44000e05,
            5.44000e03,
            1.78920e06,
            1.91520e06,
            1.02300e06,
            1.68560e05,
            2.02560e05,
            7.50400e05,
            1.69280e03,
            5.54400e06,
            5.02400e04,
            1.87600e06,
            4.76000e05,
            6.14400e03,
            2.39040e05,
            4.70400e02,
            1.91760e05,
            1.77840e06,
            6.63000e05,
            3.70600e04,
            2.29840e04,
            1.14840e05,
            3.63800e05,
            2.37660e04,
            5.07600e03,
            4.64400e04,
            7.51400e04,
            3.32180e05,
            5.27000e05,
            9.15800e05,
            1.91520e03,
            2.55600e06,
            1.25120e06,
            1.09800e04,
            6.48000e04,
            1.59460e05,
            2.73240e03,
            1.64920e06,
            3.11760e03,
            1.54440e04,
            2.89080e04,
            1.01160e07,
            2.47860e05,
            6.62400e03,
        )

        Mb = (
            3.15323e02,
            3.43201e04,
            1.23429e06,
            2.94613e03,
            1.15209e06,
            1.91264e06,
            1.15298e06,
            1.76071e05,
            2.02933e05,
            1.07282e06,
            1.03943e03,
            1.19838e07,
            7.47989e03,
            2.28810e06,
            4.02535e05,
            3.76726e03,
            2.82765e05,
            3.08524e02,
            5.32176e04,
            2.77627e06,
            7.39734e05,
            2.29558e04,
            1.23306e04,
            5.23527e04,
            2.50099e05,
            2.20405e04,
            2.57427e03,
            4.60046e04,
            2.02708e04,
            3.52313e05,
            1.02838e06,
            1.36418e06,
            7.57658e02,
            6.60047e06,
            6.14697e05,
            7.87148e03,
            8.39064e03,
            1.56208e05,
            9.09840e02,
            1.56681e06,
            1.74067e03,
            6.12227e03,
            2.10215e04,
            1.03500e07,
            2.43165e05,
            4.47952e03,
        )

        for Si, αsi, αmi, Msi, Mbi in zip(Section, αs, αm, Ms, Mb):

            with self.subTest(Si):
                Mb_calc = S5.s5_6_1_Mb(M_s=Msi, α_m=αmi, α_s=αsi)

                self.assertAlmostEqual(
                    first=Mb_calc,
                    second=Mbi,
                    delta=Mbi / Test_UT_S5.delta_p,
                    msg="Failure of the test for s5_6_1_Mb " + "with Section: " + Si,
                )
