from unittest import TestCase
import BeamDesign.AS4100.S5 as S5


class Test_UT_S5(TestCase):
    """
    This class is a unit test class for the methods in the file S5.py

    These are all bending capacity or shear methods.
    """

    delta_p = 10000  # accept an accuracy of 0.01% in these tests

    def test_s5_2_M_s(self):
        """
        Test the s5_2_M_s method against values calculated in MS Excel.
        """

        section = ('45x45x3EA', '150x150x12EA', '310UC137', '75x50x8UA',
                   '700WB173', '800WB168', '400WC181', '200x200x26EA',
                   '310UB40.4', '310UC158', '40x40x6EA', '1200WB342',
                   '180UB18.1', '500WC267', '200UBP146', '65x65x8EA',
                   '250UBP62.6', '25x25x5EA', '300PFC', '350WC280', '310UC118',
                   '125x125x12EA', '125x75x12UA', '250UB25.7', '250UBP84.9',
                   '100x100x12EA', '65x50x8UA', '150PFC', '200PFC', '250UC72.9',
                   '310UC96.8', '400WC144', '45x45x5EA', '400WC328', '610UB125',
                   '75x75x10EA', '200UB18.2', '200x200x20EA', '65x50x5UA',
                   '800WB122', '75x50x5UA', '100x100x8EA', '125TFB',
                   '1200WB455', '310UB46.2', '75x75x6EA')

        Zex = (3.19000E-06, 1.55000E-04, 2.30000E-03, 1.70000E-05, 6.39000E-03,
               6.84000E-03, 3.41000E-03, 6.02000E-04, 6.33000E-04, 2.68000E-03,
               5.29000E-06, 1.98000E-02, 1.57000E-04, 6.70000E-03, 1.70000E-03,
               1.92000E-05, 7.47000E-04, 1.47000E-06, 5.64000E-04, 4.94000E-03,
               1.95000E-03, 1.09000E-04, 6.76000E-05, 3.19000E-04, 1.07000E-03,
               6.99000E-05, 1.41000E-05, 1.29000E-04, 2.21000E-04, 9.77000E-04,
               1.55000E-03, 2.41000E-03, 5.32000E-06, 7.10000E-03, 3.68000E-03,
               3.05000E-05, 1.80000E-04, 4.69000E-04, 7.59000E-06, 4.34000E-03,
               8.66000E-06, 4.29000E-05, 8.03000E-05, 2.81000E-02, 7.29000E-04,
               1.84000E-05)

        Zey = (1.55000E-06, 7.23000E-05, 1.04000E-03, 5.93000E-06, 1.06000E-03,
               9.46000E-04, 1.51000E-03, 2.67000E-04, 1.39000E-04, 1.21000E-03,
               2.33000E-06, 2.56000E-03, 3.25000E-05, 2.97000E-03, 7.64000E-04,
               8.59000E-06, 3.18000E-04, 6.42000E-07, 7.72000E-05, 2.45000E-03,
               8.78000E-04, 4.96000E-05, 2.03000E-05, 6.17000E-05, 4.74000E-04,
               3.11000E-05, 5.86000E-06, 3.85000E-05, 4.45000E-05, 4.48000E-04,
               6.84000E-04, 1.07000E-03, 2.44000E-06, 3.20000E-03, 5.15000E-04,
               1.36000E-05, 3.44000E-05, 2.14000E-04, 3.17000E-06, 4.86000E-04,
               3.02000E-06, 2.00000E-05, 1.56000E-05, 5.00000E-03, 1.63000E-04,
               8.70000E-06)

        fy = (3.20000E+08, 3.00000E+08, 2.80000E+08, 3.20000E+08, 2.80000E+08,
              2.80000E+08, 3.00000E+08, 2.80000E+08, 3.20000E+08, 2.80000E+08,
              3.20000E+08, 2.80000E+08, 3.20000E+08, 2.80000E+08, 2.80000E+08,
              3.20000E+08, 3.20000E+08, 3.20000E+08, 3.40000E+08, 3.60000E+08,
              3.40000E+08, 3.40000E+08, 3.40000E+08, 3.60000E+08, 3.40000E+08,
              3.40000E+08, 3.60000E+08, 3.60000E+08, 3.40000E+08, 3.40000E+08,
              3.40000E+08, 3.80000E+08, 3.60000E+08, 3.60000E+08, 3.40000E+08,
              3.60000E+08, 3.60000E+08, 3.40000E+08, 3.60000E+08, 3.80000E+08,
              3.60000E+08, 3.60000E+08, 3.60000E+08, 3.60000E+08, 3.40000E+08,
              3.60000E+08)

        Msx = (1.02080E+03, 4.65000E+04, 6.44000E+05, 5.44000E+03, 1.78920E+06,
               1.91520E+06, 1.02300E+06, 1.68560E+05, 2.02560E+05, 7.50400E+05,
               1.69280E+03, 5.54400E+06, 5.02400E+04, 1.87600E+06, 4.76000E+05,
               6.14400E+03, 2.39040E+05, 4.70400E+02, 1.91760E+05, 1.77840E+06,
               6.63000E+05, 3.70600E+04, 2.29840E+04, 1.14840E+05, 3.63800E+05,
               2.37660E+04, 5.07600E+03, 4.64400E+04, 7.51400E+04, 3.32180E+05,
               5.27000E+05, 9.15800E+05, 1.91520E+03, 2.55600E+06, 1.25120E+06,
               1.09800E+04, 6.48000E+04, 1.59460E+05, 2.73240E+03, 1.64920E+06,
               3.11760E+03, 1.54440E+04, 2.89080E+04, 1.01160E+07, 2.47860E+05,
               6.62400E+03)

        Msy = (4.96000E+02, 2.16900E+04, 2.91200E+05, 1.89760E+03, 2.96800E+05,
               2.64880E+05, 4.53000E+05, 7.47600E+04, 4.44800E+04, 3.38800E+05,
               7.45600E+02, 7.16800E+05, 1.04000E+04, 8.31600E+05, 2.13920E+05,
               2.74880E+03, 1.01760E+05, 2.05440E+02, 2.62480E+04, 8.82000E+05,
               2.98520E+05, 1.68640E+04, 6.90200E+03, 2.22120E+04, 1.61160E+05,
               1.05740E+04, 2.10960E+03, 1.38600E+04, 1.51300E+04, 1.52320E+05,
               2.32560E+05, 4.06600E+05, 8.78400E+02, 1.15200E+06, 1.75100E+05,
               4.89600E+03, 1.23840E+04, 7.27600E+04, 1.14120E+03, 1.84680E+05,
               1.08720E+03, 7.20000E+03, 5.61600E+03, 1.80000E+06, 5.54200E+04,
               3.13200E+03)

        for Si, Zexi, Zeyi, fyi, Msxi, Msyi in zip(section, Zex, Zey, fy, Msx,
                                                   Msy):

            Mx = S5.s5_2_M_s(fyi, Zexi)
            My = S5.s5_2_M_s(fyi, Zeyi)

            self.assertAlmostEqual(first=Mx, second=Msxi,
                                   delta=Msxi / Test_UT_S5.delta_p,
                                   msg='Failed test for Msx, Section was :'
                                       + Si)
            self.assertAlmostEqual(first=My, second=Msyi,
                                   delta=Msyi / Test_UT_S5.delta_p,
                                   msg='Failed test for Msy, Section was :'
                                       + Si)

    def test_s5_6_1_M_o(self):
        """
        Test the s5_6_1_M_o method against values calculated in Excel.

        β_x is assumed to be 0.0000
        """

        Section = ('45x45x3EA', '150x150x12EA', '310UC137', '75x50x8UA',
                   '700WB173', '800WB168', '400WC181', '200x200x26EA',
                   '310UB40.4', '310UC158', '40x40x6EA', '1200WB342',
                   '180UB18.1', '500WC267', '200UBP146', '65x65x8EA',
                   '250UBP62.6', '25x25x5EA', '300PFC', '350WC280', '310UC118',
                   '125x125x12EA', '125x75x12UA', '250UB25.7', '250UBP84.9',
                   '100x100x12EA', '65x50x8UA', '150PFC', '200PFC', '250UC72.9',
                   '310UC96.8', '400WC144', '45x45x5EA', '400WC328', '610UB125',
                   '75x75x10EA', '200UB18.2', '200x200x20EA', '65x50x5UA',
                   '800WB122', '75x50x5UA', '100x100x8EA', '125TFB',
                   '1200WB455', '310UB46.2', '75x75x6EA')

        le = (6.71748E+00, 5.00175E+00, 8.39480E+00, 7.88096E+00, 8.15890E+00,
              4.44118E+00, 3.39838E+00, 7.70670E+00, 1.60749E+00, 9.67610E-01,
              4.39861E+00, 3.69312E+00, 8.87880E+00, 2.64963E+00, 9.01857E+00,
              5.86595E+00, 1.85971E+00, 3.19589E+00, 9.19554E+00, 2.27102E+00,
              1.02159E+00, 9.13501E+00, 7.77546E+00, 3.73183E+00, 7.00531E+00,
              6.78814E+00, 7.90351E+00, 1.08615E+00, 9.58450E+00, 5.63679E+00,
              2.36882E+00, 1.18624E+00, 7.14942E+00, 9.28371E-01, 8.31483E+00,
              4.03320E+00, 8.68449E+00, 3.60536E+00, 8.10943E+00, 3.04344E+00,
              4.53965E+00, 9.00473E+00, 1.05809E+00, 8.29448E+00, 2.88927E+00,
              6.17874E+00)

        Iy = (2.06000E-08, 3.06000E-06, 1.07000E-04, 1.06000E-07, 9.71000E-05,
              8.67000E-05, 2.14000E-04, 1.49000E-05, 7.65000E-06, 1.25000E-04,
              2.65000E-08, 3.42000E-04, 9.75000E-07, 5.21000E-04, 5.55000E-05,
              1.54000E-07, 2.97000E-05, 4.69000E-09, 4.04000E-06, 2.86000E-04,
              9.02000E-05, 1.73000E-06, 5.85000E-07, 2.55000E-06, 4.20000E-05,
              8.57000E-07, 9.36000E-08, 1.29000E-06, 1.65000E-06, 3.88000E-05,
              7.29000E-05, 1.71000E-04, 3.03000E-08, 4.27000E-04, 3.93000E-05,
              2.82000E-07, 1.14000E-06, 1.18000E-05, 5.87000E-08, 4.17000E-05,
              6.66000E-08, 5.82000E-07, 3.37000E-07, 8.34000E-04, 9.01000E-06,
              1.87000E-07)

        J = (8.75000E-10, 1.74000E-07, 2.52000E-06, 1.95000E-08, 4.02000E-06,
             2.99000E-06, 3.08000E-06, 2.25000E-06, 1.57000E-07, 3.81000E-06,
             5.60000E-09, 9.96000E-06, 4.48000E-08, 6.37000E-06, 5.98000E-06,
             2.00000E-08, 3.45000E-07, 1.66000E-09, 2.90000E-07, 1.65000E-05,
             1.63000E-06, 1.41000E-07, 1.10000E-07, 6.74000E-08, 8.27000E-07,
             1.10000E-07, 1.76000E-08, 5.49000E-08, 1.01000E-07, 5.86000E-07,
             9.28000E-07, 1.58000E-06, 2.96000E-09, 1.92000E-05, 1.56000E-06,
             4.19000E-08, 3.86000E-08, 1.06000E-06, 3.87000E-09, 9.21000E-07,
             4.32000E-09, 3.17000E-08, 4.02000E-08, 2.20000E-05, 2.33000E-07,
             1.12000E-08)

        Iw = (0.00000E+00, 0.00000E+00, 2.39000E-06, 0.00000E+00, 1.15000E-05,
              1.34000E-05, 7.31000E-06, 0.00000E+00, 1.65000E-07, 2.86000E-06,
              0.00000E+00, 1.13000E-04, 6.80000E-09, 2.94000E-05, 6.30000E-07,
              0.00000E+00, 4.15000E-07, 0.00000E+00, 5.82000E-08, 7.10000E-06,
              1.98000E-06, 0.00000E+00, 0.00000E+00, 3.67000E-08, 6.03000E-07,
              0.00000E+00, 0.00000E+00, 4.59000E-09, 1.06000E-08, 5.57000E-07,
              1.56000E-06, 5.72000E-06, 0.00000E+00, 1.62000E-05, 3.45000E-06,
              0.00000E+00, 1.04000E-08, 0.00000E+00, 0.00000E+00, 6.28000E-06,
              0.00000E+00, 0.00000E+00, 1.14000E-09, 2.80000E-04, 1.97000E-07,
              0.00000E+00)

        E = (2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11,
             2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11,
             2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11,
             2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11,
             2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11,
             2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11,
             2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11,
             2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11,
             2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11,
             2.00000E+11)

        G = (8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10,
             8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10,
             8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10,
             8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10,
             8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10,
             8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10,
             8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10,
             8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10,
             8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10,
             8.00000E+10)

        Mo0 = (2.51154E+02, 5.79727E+04, 8.97126E+05, 2.29246E+03, 1.38125E+06,
               3.70284E+06, 7.39670E+06, 2.98556E+05, 8.99975E+05, 4.08579E+07,
               1.10055E+03, 2.91357E+07, 9.57360E+03, 3.58544E+07, 8.15457E+05,
               3.75965E+03, 2.11728E+06, 3.46944E+02, 4.81261E+04, 2.10220E+07,
               2.57126E+07, 2.14849E+04, 1.29646E+04, 6.18783E+04, 3.90824E+05,
               1.79740E+04, 2.04072E+03, 1.61422E+05, 1.71625E+04, 4.43184E+05,
               3.99708E+06, 4.42155E+07, 5.26388E+02, 1.94387E+08, 5.00557E+05,
               1.07100E+04, 1.00128E+04, 3.89812E+05, 7.38574E+02, 3.54230E+06,
               1.48479E+03, 5.99419E+03, 5.57239E+04, 1.53084E+07, 3.72767E+05,
               2.94334E+03)

        for Si, lei, Iyi, Ji, Iwi, Ei, Gi, Mo0i in zip(Section, le, Iy, J, Iw,
                                                       E, G, Mo0):

            # first check βx = 0
            M = S5.s5_6_1_M_o(lei, Iyi, Ji, Iwi, 0., Ei, Gi)

            self.assertAlmostEqual(first=M, second=Mo0i,
                                   delta=Mo0i / Test_UT_S5.delta_p,
                                   msg='Test of M_o method failed on ' +
                                       'Section: ' + Si)

    def test_s5_6_1_M_o_β_x_rand(self):
        """
        Test the s5_6_1_M_o method against values calculated in Excel.

        Currently β_x is a random number as an accurate means of calculating β_x
        has not yet been implemented.
        """

        # TODO: implement check with accurate values of β_x

        Section = ('45x45x3EA', '150x150x12EA', '310UC137', '75x50x8UA',
                   '700WB173', '800WB168', '400WC181', '200x200x26EA',
                   '310UB40.4', '310UC158', '40x40x6EA', '1200WB342',
                   '180UB18.1', '500WC267', '200UBP146', '65x65x8EA',
                   '250UBP62.6', '25x25x5EA', '300PFC', '350WC280', '310UC118',
                   '125x125x12EA', '125x75x12UA', '250UB25.7', '250UBP84.9',
                   '100x100x12EA', '65x50x8UA', '150PFC', '200PFC', '250UC72.9',
                   '310UC96.8', '400WC144', '45x45x5EA', '400WC328', '610UB125',
                   '75x75x10EA', '200UB18.2', '200x200x20EA', '65x50x5UA',
                   '800WB122', '75x50x5UA', '100x100x8EA', '125TFB',
                   '1200WB455', '310UB46.2', '75x75x6EA')

        le = (6.71748E+00, 5.00175E+00, 8.39480E+00, 7.88096E+00, 8.15890E+00,
              4.44118E+00, 3.39838E+00, 7.70670E+00, 1.60749E+00, 9.67610E-01,
              4.39861E+00, 3.69312E+00, 8.87880E+00, 2.64963E+00, 9.01857E+00,
              5.86595E+00, 1.85971E+00, 3.19589E+00, 9.19554E+00, 2.27102E+00,
              1.02159E+00, 9.13501E+00, 7.77546E+00, 3.73183E+00, 7.00531E+00,
              6.78814E+00, 7.90351E+00, 1.08615E+00, 9.58450E+00, 5.63679E+00,
              2.36882E+00, 1.18624E+00, 7.14942E+00, 9.28371E-01, 8.31483E+00,
              4.03320E+00, 8.68449E+00, 3.60536E+00, 8.10943E+00, 3.04344E+00,
              4.53965E+00, 9.00473E+00, 1.05809E+00, 8.29448E+00, 2.88927E+00,
              6.17874E+00)

        Iy = (2.06000E-08, 3.06000E-06, 1.07000E-04, 1.06000E-07, 9.71000E-05,
              8.67000E-05, 2.14000E-04, 1.49000E-05, 7.65000E-06, 1.25000E-04,
              2.65000E-08, 3.42000E-04, 9.75000E-07, 5.21000E-04, 5.55000E-05,
              1.54000E-07, 2.97000E-05, 4.69000E-09, 4.04000E-06, 2.86000E-04,
              9.02000E-05, 1.73000E-06, 5.85000E-07, 2.55000E-06, 4.20000E-05,
              8.57000E-07, 9.36000E-08, 1.29000E-06, 1.65000E-06, 3.88000E-05,
              7.29000E-05, 1.71000E-04, 3.03000E-08, 4.27000E-04, 3.93000E-05,
              2.82000E-07, 1.14000E-06, 1.18000E-05, 5.87000E-08, 4.17000E-05,
              6.66000E-08, 5.82000E-07, 3.37000E-07, 8.34000E-04, 9.01000E-06,
              1.87000E-07)

        J = (8.75000E-10, 1.74000E-07, 2.52000E-06, 1.95000E-08, 4.02000E-06,
             2.99000E-06, 3.08000E-06, 2.25000E-06, 1.57000E-07, 3.81000E-06,
             5.60000E-09, 9.96000E-06, 4.48000E-08, 6.37000E-06, 5.98000E-06,
             2.00000E-08, 3.45000E-07, 1.66000E-09, 2.90000E-07, 1.65000E-05,
             1.63000E-06, 1.41000E-07, 1.10000E-07, 6.74000E-08, 8.27000E-07,
             1.10000E-07, 1.76000E-08, 5.49000E-08, 1.01000E-07, 5.86000E-07,
             9.28000E-07, 1.58000E-06, 2.96000E-09, 1.92000E-05, 1.56000E-06,
             4.19000E-08, 3.86000E-08, 1.06000E-06, 3.87000E-09, 9.21000E-07,
             4.32000E-09, 3.17000E-08, 4.02000E-08, 2.20000E-05, 2.33000E-07,
             1.12000E-08)

        Iw = (0.00000E+00, 0.00000E+00, 2.39000E-06, 0.00000E+00, 1.15000E-05,
              1.34000E-05, 7.31000E-06, 0.00000E+00, 1.65000E-07, 2.86000E-06,
              0.00000E+00, 1.13000E-04, 6.80000E-09, 2.94000E-05, 6.30000E-07,
              0.00000E+00, 4.15000E-07, 0.00000E+00, 5.82000E-08, 7.10000E-06,
              1.98000E-06, 0.00000E+00, 0.00000E+00, 3.67000E-08, 6.03000E-07,
              0.00000E+00, 0.00000E+00, 4.59000E-09, 1.06000E-08, 5.57000E-07,
              1.56000E-06, 5.72000E-06, 0.00000E+00, 1.62000E-05, 3.45000E-06,
              0.00000E+00, 1.04000E-08, 0.00000E+00, 0.00000E+00, 6.28000E-06,
              0.00000E+00, 0.00000E+00, 1.14000E-09, 2.80000E-04, 1.97000E-07,
              0.00000E+00)

        βx = (1.28173E-01, -1.42314E-01, 1.78449E-01, 2.45703E-01, -1.48817E-01,
              1.90016E-01, -3.08997E-02, 2.27412E-01, -4.31823E-02, 2.32830E-01,
              7.81551E-02, -1.81195E-01, -2.03927E-01, 6.99328E-02,
              -1.73018E-01, 1.61423E-01, -1.78620E-01, -1.16781E-01,
              4.82682E-02, -1.22808E-01, 4.07138E-02, 6.11456E-02, 2.12952E-01,
              -1.25923E-01, -3.82946E-02, 1.14895E-01, -8.74274E-03,
              -1.73450E-01, 2.35091E-01, 1.89466E-02, 1.48394E-01, -2.44949E-01,
              1.32684E-01, 8.93709E-02, 4.72989E-02, -4.30083E-02, -1.44619E-01,
              4.54835E-02, -1.31337E-01, 5.14391E-02, -1.30045E-01,
              -8.56207E-02, -1.38838E-01, 8.20854E-02, 1.10207E-01, 1.86297E-01)

        E = (2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11,
             2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11,
             2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11,
             2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11,
             2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11,
             2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11,
             2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11,
             2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11,
             2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11, 2.00000E+11,
             2.00000E+11)

        G = (8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10,
             8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10,
             8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10,
             8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10,
             8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10,
             8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10,
             8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10,
             8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10,
             8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10, 8.00000E+10,
             8.00000E+10)

        Mo = (3.15458E+02, 4.32847E+04, 1.20354E+06, 2.74338E+03, 1.18352E+06,
              4.61784E+06, 6.85316E+06, 3.60126E+05, 7.82603E+05, 8.17736E+07,
              1.21126E+03, 2.49946E+07, 7.40267E+03, 4.13406E+07, 7.07217E+05,
              4.53970E+03, 1.08894E+06, 2.98032E+02, 5.04559E+04, 1.53491E+07,
              2.94190E+07, 2.27724E+04, 1.51568E+04, 4.31738E+04, 3.59813E+05,
              2.02064E+04, 2.02784E+03, 5.99878E+04, 2.18288E+04, 4.66607E+05,
              6.32959E+06, 2.37074E+07, 6.09709E+02, 2.42938E+08, 5.27796E+05,
              9.99943E+03, 8.08513E+03, 4.32687E+05, 6.31879E+02, 3.77822E+06,
              1.12686E+03, 5.41826E+03, 2.80816E+04, 1.63219E+07, 5.08213E+05,
              3.97868E+03)

        for Si, lei, Iyi, Ji, Iwi, βxi, Ei, Gi, Moi in zip(Section, le, Iy, J,
                                                           Iw, βx, E, G, Mo):

            M = S5.s5_6_1_M_o(lei, Iyi, Ji, Iwi, βxi, Ei, Gi)

            self.assertAlmostEqual(first=M, second=Moi,
                                   delta=Moi / Test_UT_S5.delta_p,
                                   msg='Check of M_o method failed on ' +
                                       'Section: ' + Si + '.')

    def test_s5_6_1_α_m(self):
        """
        Test the s5_6_1_α_m method against values calculated in excel.
        """

        Section = ('45x45x3EA', '150x150x12EA', '310UC137', '75x50x8UA',
                   '700WB173', '800WB168', '400WC181', '200x200x26EA',
                   '310UB40.4', '310UC158', '40x40x6EA', '1200WB342',
                   '180UB18.1', '500WC267', '200UBP146', '65x65x8EA',
                   '250UBP62.6', '25x25x5EA', '300PFC', '350WC280', '310UC118',
                   '125x125x12EA', '125x75x12UA', '250UB25.7', '250UBP84.9',
                   '100x100x12EA', '65x50x8UA', '150PFC', '200PFC', '250UC72.9',
                   '310UC96.8', '400WC144', '45x45x5EA', '400WC328', '610UB125',
                   '75x75x10EA', '200UB18.2', '200x200x20EA', '65x50x5UA',
                   '800WB122', '75x50x5UA', '100x100x8EA', '125TFB',
                   '1200WB455', '310UB46.2', '75x75x6EA')

        Mmax = (4.67469E+05, 3.49510E+05, 3.47664E+05, 2.67263E+05, 2.32884E+05,
                3.44566E+05, 2.72960E+05, 1.64726E+05, 2.00472E+05, 4.20864E+05,
                4.26130E+05, 4.24465E+05, 4.07899E+05, 2.87867E+05, 4.14763E+05,
                2.82995E+05, 4.78969E+05, 4.00384E+05, 9.92535E+04, 1.89387E+05,
                4.60724E+05, 4.86889E+05, 2.91128E+05, 3.04559E+05, 4.67600E+05,
                3.60335E+05, 4.88652E+05, 4.96792E+05, 3.86504E+05, 4.57667E+05,
                4.39645E+05, 3.93075E+05, 9.03782E+04, 3.93286E+05, 4.40849E+05,
                3.28920E+05, 4.56775E+05, 4.12964E+05, 4.01556E+05, 4.61276E+05,
                4.65965E+05, 4.85649E+05, 2.69758E+05, 2.76627E+05, 4.30286E+05,
                4.85566E+05)

        M2 = (-4.67469E+05, -1.42941E+05, 3.37893E+04, -7.93088E+04,
              2.32884E+05, -3.30326E+05, -2.25569E+05, 1.48658E+05, 1.85336E+05,
              2.99774E+05, -1.66170E+05, 1.84504E+05, -2.84170E+05,
              -2.87867E+05, -4.14763E+05, 2.78503E+05, 4.78969E+05,
              -1.98291E+05, 9.92535E+04, 6.57249E+04, 4.32001E+05, 3.28003E+05,
              1.45176E+05, -3.04559E+05, -4.43804E+05, 3.60335E+05,
              -4.88652E+05, 1.88432E+05, -3.50844E+05, 4.57667E+05,
              -2.79432E+05, 5.63936E+04, 2.85457E+04, -3.54995E+04,
              -2.14387E+05, 1.90845E+05, 4.56775E+05, -1.89878E+05,
              -1.25864E+05, -1.91055E+05, 3.61256E+05, -2.80688E+05,
              2.69758E+05, 1.45844E+05, 4.93166E+04, -3.66316E+05)

        M3 = (3.09832E+05, 3.49510E+05, 3.99423E+04, -2.67263E+05, 1.52122E+05,
              3.44566E+05, 2.72960E+05, -1.51186E+05, -2.00472E+05, 2.53132E+04,
              -4.26130E+05, 3.75895E+04, -3.49868E+05, 2.32965E+05, 3.54572E+05,
              -2.82995E+05, -3.35897E+05, 1.65104E+05, -9.46127E+04,
              -1.01430E+03, -3.45896E+05, 4.86889E+05, -2.88577E+05,
              1.60939E+05, -3.10001E+05, 2.85896E+04, -1.60857E+05,
              -4.96792E+05, -2.97685E+05, -3.55650E+04, -7.08319E+04,
              2.23977E+05, 4.25752E+04, 3.47805E+04, -4.40849E+05, 3.28920E+05,
              -2.31485E+05, -3.96210E+05, 1.41539E+05, 4.61276E+05,
              -1.16695E+05, 4.85649E+05, 4.48760E+04, 2.76627E+05, 3.95937E+05,
              -2.52989E+05)

        M4 = (-3.67540E+05, -2.72333E+05, 1.34665E+05, -1.71207E+05,
              -8.34585E+04, 5.79356E+04, -1.69507E+05, 2.33500E+04, 1.35106E+05,
              -4.20864E+05, -3.66534E+05, -2.40353E+05, -4.07899E+05,
              -1.66892E+05, -2.31913E+05, 2.20148E+04, 2.34881E+05,
              -4.00384E+05, -4.26201E+03, 1.89387E+05, 4.60724E+05,
              -1.27297E+05, 2.91128E+05, -6.42444E+04, 4.27759E+05, 3.94525E+04,
              -1.33635E+05, -2.18382E+05, -3.86504E+05, -2.24250E+05,
              -2.46608E+05, 3.93075E+05, 9.03782E+04, -1.49941E+05, 1.65647E+05,
              2.32781E+05, 4.25411E+05, -4.12964E+05, -3.64551E+05,
              -4.44435E+05, 1.87597E+05, -2.29443E+05, 2.53479E+05,
              -1.23990E+05, -4.30286E+05, 3.05971E+05)

        αm_max = (2.50000E+00, 2.50000E+00, 2.50000E+00, 2.50000E+00,
                  2.50000E+00, 2.50000E+00, 2.50000E+00, 2.50000E+00,
                  2.50000E+00, 2.50000E+00, 2.50000E+00, 2.50000E+00,
                  2.50000E+00, 2.50000E+00, 2.50000E+00, 2.50000E+00,
                  2.50000E+00, 2.50000E+00, 2.50000E+00, 2.50000E+00,
                  2.50000E+00, 2.50000E+00, 2.50000E+00, 2.50000E+00,
                  2.50000E+00, 2.50000E+00, 2.50000E+00, 2.50000E+00,
                  2.50000E+00, 2.50000E+00, 2.50000E+00, 2.50000E+00,
                  2.50000E+00, 2.50000E+00, 2.50000E+00, 2.50000E+00,
                  2.50000E+00, 2.50000E+00, 2.50000E+00, 2.50000E+00,
                  2.50000E+00, 2.50000E+00, 2.50000E+00, 2.50000E+00,
                  2.50000E+00, 2.50000E+00)

        αm = (1.18518E+00, 1.27622E+00, 2.50000E+00, 1.38878E+00, 1.36323E+00,
              1.21823E+00, 1.18200E+00, 1.31280E+00, 1.11879E+00, 1.38300E+00,
              1.23594E+00, 2.36334E+00, 1.14069E+00, 1.20478E+00, 1.18923E+00,
              1.20980E+00, 1.29163E+00, 1.42896E+00, 1.22991E+00, 1.60601E+00,
              1.08768E+00, 1.37789E+00, 1.13809E+00, 1.47757E+00, 1.15213E+00,
              1.68467E+00, 1.56289E+00, 1.47017E+00, 1.09344E+00, 1.52289E+00,
              1.97015E+00, 1.46570E+00, 1.47872E+00, 2.50000E+00, 1.44836E+00,
              1.25411E+00, 1.16641E+00, 1.16430E+00, 1.66167E+00, 1.17315E+00,
              1.87065E+00, 1.36229E+00, 1.22988E+00, 1.39793E+00, 1.24655E+00,
              1.52809E+00)

        for Si, Mmi, M2i, M3i, M4i, αmmi, αmi in zip(Section, Mmax, M2, M3, M4,
                                                     αm_max, αm):

            αm_calc = S5.s5_6_1_α_m(Mmi, M2i, M3i, M4i, αmmi)

            self.assertAlmostEqual(first=αm_calc, second=αmi,
                                   delta=αmi / Test_UT_S5.delta_p)

    def test_s5_6_α_s(self):
        """
        Test the s5_6_α_s method against values calculated in Excel.
        """

        Section = ('45x45x3EA', '150x150x12EA', '310UC137', '75x50x8UA',
                   '700WB173', '800WB168', '400WC181', '200x200x26EA',
                   '310UB40.4', '310UC158', '40x40x6EA', '1200WB342',
                   '180UB18.1', '500WC267', '200UBP146', '65x65x8EA',
                   '250UBP62.6', '25x25x5EA', '300PFC', '350WC280', '310UC118',
                   '125x125x12EA', '125x75x12UA', '250UB25.7', '250UBP84.9',
                   '100x100x12EA', '65x50x8UA', '150PFC', '200PFC', '250UC72.9',
                   '310UC96.8', '400WC144', '45x45x5EA', '400WC328', '610UB125',
                   '75x75x10EA', '200UB18.2', '200x200x20EA', '65x50x5UA',
                   '800WB122', '75x50x5UA', '100x100x8EA', '125TFB',
                   '1200WB455', '310UB46.2', '75x75x6EA')

        Mo = (3.15458E+02, 4.32847E+04, 1.20354E+06, 2.74338E+03, 1.18352E+06,
              4.61784E+06, 6.85316E+06, 3.60126E+05, 7.82603E+05, 8.17736E+07,
              1.21126E+03, 2.49946E+07, 7.40267E+03, 4.13406E+07, 7.07217E+05,
              4.53970E+03, 1.08894E+06, 2.98032E+02, 5.04559E+04, 1.53491E+07,
              2.94190E+07, 2.27724E+04, 1.51568E+04, 4.31738E+04, 3.59813E+05,
              2.02064E+04, 2.02784E+03, 5.99878E+04, 2.18288E+04, 4.66607E+05,
              6.32959E+06, 2.37074E+07, 6.09709E+02, 2.42938E+08, 5.27796E+05,
              9.99943E+03, 8.08513E+03, 4.32687E+05, 6.31879E+02, 3.77822E+06,
              1.12686E+03, 5.41826E+03, 2.80816E+04, 1.63219E+07, 5.08213E+05,
              3.97868E+03)

        Ms = (1.02080E+03, 4.65000E+04, 6.44000E+05, 5.44000E+03, 1.78920E+06,
              1.91520E+06, 1.02300E+06, 1.68560E+05, 2.02560E+05, 7.50400E+05,
              1.69280E+03, 5.54400E+06, 5.02400E+04, 1.87600E+06, 4.76000E+05,
              6.14400E+03, 2.39040E+05, 4.70400E+02, 1.91760E+05, 1.77840E+06,
              6.63000E+05, 3.70600E+04, 2.29840E+04, 1.14840E+05, 3.63800E+05,
              2.37660E+04, 5.07600E+03, 4.64400E+04, 7.51400E+04, 3.32180E+05,
              5.27000E+05, 9.15800E+05, 1.91520E+03, 2.55600E+06, 1.25120E+06,
              1.09800E+04, 6.48000E+04, 1.59460E+05, 2.73240E+03, 1.64920E+06,
              3.11760E+03, 1.54440E+04, 2.89080E+04, 1.01160E+07, 2.47860E+05,
              6.62400E+03)

        αs = (2.60634E-01, 5.78325E-01, 7.66640E-01, 3.89961E-01, 4.72346E-01,
              8.19764E-01, 9.53518E-01, 7.95673E-01, 8.95473E-01, 1.03374E+00,
              4.96810E-01, 9.14632E-01, 1.30520E-01, 1.01236E+00, 7.11100E-01,
              5.06828E-01, 9.15833E-01, 4.58986E-01, 2.25644E-01, 9.72035E-01,
              1.02580E+00, 4.49544E-01, 4.71391E-01, 3.08530E-01, 5.96690E-01,
              5.50490E-01, 3.24491E-01, 6.73818E-01, 2.46721E-01, 6.96445E-01,
              9.90475E-01, 1.01631E+00, 2.67530E-01, 1.03294E+00, 3.39203E-01,
              5.71637E-01, 1.11012E-01, 8.41374E-01, 2.00390E-01, 8.09823E-01,
              2.98472E-01, 2.90993E-01, 5.91268E-01, 7.31892E-01, 7.87018E-01,
              4.42550E-01)

        for Si, Moi, Msi, αsi in zip(Section, Mo, Ms, αs):

            αs_calc = S5.s5_6_α_s(Msi, Moi)

            self.assertAlmostEqual(first=αs_calc, second=αsi,
                                   delta=αsi / Test_UT_S5.delta_p)

    def test_s5_6_3_k_t(self):
        """
        Test the s5_6_3_k_t method against values calculated in Excel.

        Note that to check the effect of multiple webs a random no. of webs has
        been chosen and applied to section properties taken from I sections,
        not from real hollow sections.
        """

        Section = ('310UC137', '700WB173', '800WB168', '400WC181', '310UB40.4',
                   '310UC158', '1200WB342', '180UB18.1', '500WC267',
                   '200UBP146', '250UBP62.6', '300PFC', '350WC280', '310UC118',
                   '250UB25.7', '250UBP84.9', '150PFC', '200PFC', '250UC72.9',
                   '310UC96.8', '400WC144', '400WC328', '610UB125', '200UB18.2',
                   '800WB122', '125TFB', '1200WB455', '310UB46.2', '200UC46.2',
                   '250UB31.4', '500WC340', '460UB82.1', '100TFB', '250UC89.5',
                   '460UB74.6', '100PFC', '250UB37.3', '400WC212', '180UB16.1',
                   '1200WB249', '360UB44.7', '350WC258', '310UC137', '700WB173',
                   '800WB168', '400WC181', '310UB40.4', '310UC158', '180UB18.1',
                   '500WC267', '200UBP146', '250UBP62.6', '300PFC', '350WC280',
                   '310UC118', '250UBP84.9', '150PFC', '200PFC', '250UC72.9',
                   '310UC96.8', '400WC144', '610UB125', '200UB18.2', '800WB122',
                   '125TFB', '1200WB455', '310UB46.2', '200UC46.2', '250UB31.4',
                   '500WC340', '100TFB', '250UC89.5', '460UB74.6', '100PFC',
                   '250UB37.3', '400WC212', '180UB16.1', '1200WB249',
                   '150UB14.0', '350WC258')

        Restraint = ('PL', 'PL', 'FP', 'FP', 'FF', 'PU', 'PP', 'PP', 'PP', 'FF',
                     'LL', 'PL', 'FF', 'PL', 'PL', 'PL', 'FU', 'PU', 'FP', 'LL',
                     'FL', 'FP', 'PL', 'LL', 'FU', 'FL', 'FL', 'PL', 'PL', 'PL',
                     'FU', 'PP', 'FF', 'FP', 'PL', 'LL', 'FF', 'PU', 'PU', 'FP',
                     'PP', 'LL', 'PL', 'PL', 'FP', 'FP', 'FF', 'PU', 'PP', 'PP',
                     'FF', 'LL', 'PL', 'FF', 'PL', 'PL', 'FU', 'PU', 'FP', 'LL',
                     'FL', 'PL', 'LL', 'FU', 'FL', 'FL', 'PL', 'PL', 'PL', 'FU',
                     'FF', 'FP', 'PL', 'LL', 'FF', 'PU', 'PU', 'FP', 'LL', 'LL')

        d1 = (2.776E-01, 6.600E-01, 7.600E-01, 3.500E-01, 2.836E-01, 2.770E-01,
              1.120E+00, 1.590E-01, 4.500E-01, 1.810E-01, 2.258E-01, 2.680E-01,
              2.750E-01, 2.776E-01, 2.320E-01, 2.254E-01, 1.310E-01, 1.760E-01,
              2.256E-01, 2.772E-01, 3.500E-01, 3.500E-01, 5.728E-01, 1.840E-01,
              7.600E-01, 1.080E-01, 1.120E+00, 2.834E-01, 1.810E-01, 2.348E-01,
              4.500E-01, 4.280E-01, 8.800E-02, 2.254E-01, 4.280E-01, 8.660E-02,
              2.342E-01, 3.500E-01, 1.590E-01, 1.120E+00, 3.326E-01, 2.750E-01,
              2.776E-01, 6.600E-01, 7.600E-01, 3.500E-01, 2.836E-01, 2.770E-01,
              1.590E-01, 4.500E-01, 1.810E-01, 2.258E-01, 2.680E-01, 2.750E-01,
              2.776E-01, 2.254E-01, 1.310E-01, 1.760E-01, 2.256E-01, 2.772E-01,
              3.500E-01, 5.728E-01, 1.840E-01, 7.600E-01, 1.080E-01, 1.120E+00,
              2.834E-01, 1.810E-01, 2.348E-01, 4.500E-01, 8.800E-02, 2.254E-01,
              4.280E-01, 8.660E-02, 2.342E-01, 3.500E-01, 1.590E-01, 1.120E+00,
              1.360E-01, 2.750E-01)

        l = (2.130E+00, 6.738E+00, 2.000E+00, 8.852E+00, 6.465E+00, 4.929E+00,
             3.466E+00, 4.726E+00, 7.918E-01, 4.955E+00, 9.534E-01, 2.401E+00,
             8.997E+00, 4.374E+00, 4.472E+00, 9.118E+00, 5.871E+00, 5.614E+00,
             5.843E+00, 4.930E+00, 7.537E+00, 7.459E+00, 8.461E-01, 3.416E-01,
             5.972E+00, 1.049E+00, 5.348E+00, 6.745E+00, 4.671E+00, 1.961E+00,
             2.604E-01, 9.017E+00, 2.931E+00, 5.898E+00, 7.874E+00, 8.199E+00,
             4.505E+00, 2.296E+00, 3.582E-01, 3.598E+00, 1.825E+00, 2.740E+00,
             2.130E+00, 6.738E+00, 2.000E+00, 8.852E+00, 6.465E+00, 4.929E+00,
             4.726E+00, 7.918E-01, 4.955E+00, 9.534E-01, 2.401E+00, 8.997E+00,
             4.374E+00, 9.118E+00, 5.871E+00, 5.614E+00, 5.843E+00, 4.930E+00,
             7.537E+00, 8.461E-01, 3.416E-01, 5.972E+00, 1.049E+00, 5.348E+00,
             6.745E+00, 4.671E+00, 1.961E+00, 2.604E-01, 2.931E+00, 5.898E+00,
             7.874E+00, 8.199E+00, 4.505E+00, 2.296E+00, 3.582E-01, 3.598E+00,
             8.026E+00, 2.740E+00)

        tf = (2.170E-02, 2.800E-02, 2.500E-02, 2.000E-02, 1.020E-02, 2.500E-02,
              3.200E-02, 8.000E-03, 2.500E-02, 3.200E-02, 1.060E-02, 1.600E-02,
              4.000E-02, 1.870E-02, 8.000E-03, 1.430E-02, 9.500E-03, 1.200E-02,
              1.420E-02, 1.540E-02, 1.600E-02, 4.000E-02, 1.960E-02, 7.000E-03,
              1.600E-02, 8.500E-03, 4.000E-02, 1.180E-02, 1.100E-02, 8.600E-03,
              3.200E-02, 1.600E-02, 6.000E-03, 1.730E-02, 1.450E-02, 6.700E-03,
              1.090E-02, 2.500E-02, 7.000E-03, 2.500E-02, 9.700E-03, 3.600E-02,
              2.170E-02, 2.800E-02, 2.500E-02, 2.000E-02, 1.020E-02, 2.500E-02,
              8.000E-03, 2.500E-02, 3.200E-02, 1.060E-02, 1.600E-02, 4.000E-02,
              1.870E-02, 1.430E-02, 9.500E-03, 1.200E-02, 1.420E-02, 1.540E-02,
              1.600E-02, 1.960E-02, 7.000E-03, 1.600E-02, 8.500E-03, 4.000E-02,
              1.180E-02, 1.100E-02, 8.600E-03, 3.200E-02, 6.000E-03, 1.730E-02,
              1.450E-02, 6.700E-03, 1.090E-02, 2.500E-02, 7.000E-03, 2.500E-02,
              7.000E-03, 3.600E-02)

        tw = (1.380E-02, 1.000E-02, 1.000E-02, 2.000E-02, 6.100E-03, 1.570E-02,
              1.600E-02, 5.000E-03, 2.000E-02, 2.500E-02, 1.060E-02, 8.000E-03,
              2.800E-02, 1.190E-02, 5.000E-03, 1.430E-02, 6.000E-03, 6.000E-03,
              8.600E-03, 9.900E-03, 1.600E-02, 2.800E-02, 1.190E-02, 4.500E-03,
              1.000E-02, 5.000E-03, 1.600E-02, 6.700E-03, 7.300E-03, 6.100E-03,
              2.500E-02, 9.900E-03, 4.000E-03, 1.050E-02, 9.100E-03, 4.200E-03,
              6.400E-03, 2.000E-02, 4.500E-03, 1.600E-02, 6.900E-03, 2.800E-02,
              1.380E-02, 1.000E-02, 1.000E-02, 2.000E-02, 6.100E-03, 1.570E-02,
              5.000E-03, 2.000E-02, 2.500E-02, 1.060E-02, 8.000E-03, 2.800E-02,
              1.190E-02, 1.430E-02, 6.000E-03, 6.000E-03, 8.600E-03, 9.900E-03,
              1.600E-02, 1.190E-02, 4.500E-03, 1.000E-02, 5.000E-03, 1.600E-02,
              6.700E-03, 7.300E-03, 6.100E-03, 2.500E-02, 4.000E-03, 1.050E-02,
              9.100E-03, 4.200E-03, 6.400E-03, 2.000E-02, 4.500E-03, 1.600E-02,
              5.000E-03, 2.800E-02)

        nw = (1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
              1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 1,
              2, 1, 2, 3, 3, 3, 3, 1, 3, 3, 2, 3, 2, 3, 1, 1, 1, 2, 2, 1, 3, 2,
              1, 3, 3, 3, 1, 2, 2, 2, 1, 3, 1, 1, 3, 3)

        kt = (1.06333E+0, 1.26878E+0, 1.74204E+0, 1.00494E+0, 1.00000E+0,
              1.02836E+0, 1.64627E+0, 1.03445E+0, 1.27751E+0, 1.00000E+0,
              1.00000E+0, 1.11161E+0, 1.00000E+0, 1.03078E+0, 1.02656E+0,
              1.00309E+0, 1.00000E+0, 1.03135E+0, 1.02173E+0, 1.00000E+0,
              1.00000E+0, 1.01710E+0, 1.37812E+0, 1.00000E+0, 1.00000E+0,
              1.00000E+0, 1.00000E+0, 1.02869E+0, 1.01657E+0, 1.04194E+0,
              1.00000E+0, 1.05009E+0, 1.00000E+0, 1.02137E+0, 1.02749E+0,
              1.00000E+0, 1.00000E+0, 1.03722E+0, 1.20887E+0, 1.14845E+0,
              1.12661E+0, 1.00000E+0, 1.02111E+0, 1.26878E+0, 1.37102E+0,
              1.00494E+0, 1.00000E+0, 1.00945E+0, 1.01148E+0, 1.09250E+0,
              1.00000E+0, 1.00000E+0, 1.03720E+0, 1.00000E+0, 1.01539E+0,
              1.00103E+0, 1.00000E+0, 1.01045E+0, 1.02173E+0, 1.00000E+0,
              1.00000E+0, 1.18906E+0, 1.00000E+0, 1.00000E+0, 1.00000E+0,
              1.00000E+0, 1.02869E+0, 1.00552E+0, 1.01398E+0, 1.00000E+0,
              1.00000E+0, 1.01068E+0, 1.01374E+0, 1.00000E+0, 1.00000E+0,
              1.01241E+0, 1.20887E+0, 1.14845E+0, 1.00000E+0, 1.00000E+0)

        for Si, Ri, d1i, li, tfi, twi, nwi, kti in zip(Section, Restraint, d1,
                                                       l, tf, tw, nw, kt):

            kt_calc = S5.s5_6_3_k_t(d1i, li, tfi, twi, nwi, Ri)

            self.assertAlmostEqual(first=kt_calc, second=kti,
                                   delta=kti / Test_UT_S5.delta_p,
                                   msg='Test for k_t failed with Section: '
                                       + Si + ' and n_w: ' + str(nwi))

    def test_s5_6_3_l_e(self):
        """
        Test the s5_6_3_l_e method against values calculated in Excel.
        """

        Section = ('310UC137', '700WB173', '800WB168', '400WC181', '310UB40.4',
                   '310UC158', '1200WB342', '180UB18.1', '500WC267',
                   '200UBP146', '250UBP62.6', '300PFC', '350WC280', '310UC118',
                   '250UB25.7', '250UBP84.9', '150PFC', '200PFC', '250UC72.9',
                   '310UC96.8', '400WC144', '400WC328', '610UB125', '200UB18.2',
                   '800WB122', '125TFB', '1200WB455', '310UB46.2', '200UC46.2',
                   '250UB31.4', '500WC340', '460UB82.1', '100TFB', '250UC89.5',
                   '460UB74.6', '100PFC', '250UB37.3', '400WC212', '180UB16.1',
                   '1200WB249', '360UB44.7', '350WC258', '310UC137', '700WB173',
                   '800WB168', '400WC181', '310UB40.4', '310UC158', '180UB18.1',
                   '500WC267', '200UBP146', '250UBP62.6', '300PFC', '350WC280',
                   '310UC118', '250UBP84.9', '150PFC', '200PFC', '250UC72.9',
                   '310UC96.8', '400WC144', '610UB125', '200UB18.2', '800WB122',
                   '125TFB', '1200WB455', '310UB46.2', '200UC46.2', '250UB31.4',
                   '500WC340', '100TFB', '250UC89.5', '460UB74.6', '100PFC',
                   '250UB37.3', '400WC212', '180UB16.1', '1200WB249',
                   '150UB14.0', '350WC258')

        l = (2.13034E+0, 6.73795E+0, 2.00041E+0, 8.85161E+0, 6.46465E+0,
             4.92936E+0, 3.46603E+0, 4.72563E+0, 7.91790E-1, 4.95495E+0,
             9.53414E-1, 2.40115E+0, 8.99675E+0, 4.37433E+0, 4.47163E+0,
             9.11840E+0, 5.87125E+0, 5.61425E+0, 5.84314E+0, 4.93005E+0,
             7.53731E+0, 7.45913E+0, 8.46077E-1, 3.41592E-1, 5.97192E+0,
             1.04903E+0, 5.34757E+0, 6.74515E+0, 4.67074E+0, 1.96118E+0,
             2.60397E-1, 9.01746E+0, 2.93118E+0, 5.89788E+0, 7.87351E+0,
             8.19891E+0, 4.50496E+0, 2.29588E+0, 3.58172E-1, 3.59750E+0,
             1.82458E+0, 2.73999E+0, 2.13034E+0, 6.73795E+0, 2.00041E+0,
             8.85161E+0, 6.46465E+0, 4.92936E+0, 4.72563E+0, 7.91790E-1,
             4.95495E+0, 9.53414E-1, 2.40115E+0, 8.99675E+0, 4.37433E+0,
             9.11840E+0, 5.87125E+0, 5.61425E+0, 5.84314E+0, 4.93005E+0,
             7.53731E+0, 8.46077E-1, 3.41592E-1, 5.97192E+0, 1.04903E+0,
             5.34757E+0, 6.74515E+0, 4.67074E+0, 1.96118E+0, 2.60397E-1,
             2.93118E+0, 5.89788E+0, 7.87351E+0, 8.19891E+0, 4.50496E+0,
             2.29588E+0, 3.58172E-1, 3.59750E+0, 8.02550E+0, 2.73999E+0)

        kt = (1.0633E+0, 1.2688E+0, 1.7420E+0, 1.0049E+0, 1.0000E+0, 1.0284E+0,
              1.6463E+0, 1.0345E+0, 1.2775E+0, 1.0000E+0, 1.0000E+0, 1.1116E+0,
              1.0000E+0, 1.0308E+0, 1.0266E+0, 1.0031E+0, 1.0000E+0, 1.0313E+0,
              1.0217E+0, 1.0000E+0, 1.0000E+0, 1.0171E+0, 1.3781E+0, 1.0000E+0,
              1.0000E+0, 1.0000E+0, 1.0000E+0, 1.0287E+0, 1.0166E+0, 1.0419E+0,
              1.0000E+0, 1.0501E+0, 1.0000E+0, 1.0214E+0, 1.0275E+0, 1.0000E+0,
              1.0000E+0, 1.0372E+0, 1.2089E+0, 1.1485E+0, 1.1266E+0, 1.0000E+0,
              1.0211E+0, 1.2688E+0, 1.3710E+0, 1.0049E+0, 1.0000E+0, 1.0095E+0,
              1.0115E+0, 1.0925E+0, 1.0000E+0, 1.0000E+0, 1.0372E+0, 1.0000E+0,
              1.0154E+0, 1.0010E+0, 1.0000E+0, 1.0104E+0, 1.0217E+0, 1.0000E+0,
              1.0000E+0, 1.1891E+0, 1.0000E+0, 1.0000E+0, 1.0000E+0, 1.0000E+0,
              1.0287E+0, 1.0055E+0, 1.0140E+0, 1.0000E+0, 1.0000E+0, 1.0107E+0,
              1.0137E+0, 1.0000E+0, 1.0000E+0, 1.0124E+0, 1.2089E+0, 1.1485E+0,
              1.0000E+0, 1.0000E+0)

        kl = (1.0000E+0, 2.0000E+0, 1.4000E+0, 2.0000E+0, 1.4000E+0, 2.0000E+0,
              1.4000E+0, 1.4000E+0, 2.0000E+0, 2.0000E+0, 1.0000E+0, 1.4000E+0,
              2.0000E+0, 2.0000E+0, 2.0000E+0, 1.4000E+0, 2.0000E+0, 2.0000E+0,
              1.0000E+0, 1.4000E+0, 2.0000E+0, 1.4000E+0, 1.4000E+0, 1.0000E+0,
              1.0000E+0, 1.4000E+0, 2.0000E+0, 1.0000E+0, 2.0000E+0, 2.0000E+0,
              1.0000E+0, 1.0000E+0, 1.4000E+0, 1.0000E+0, 1.4000E+0, 1.4000E+0,
              1.0000E+0, 2.0000E+0, 1.4000E+0, 1.4000E+0, 2.0000E+0, 1.0000E+0,
              1.4000E+0, 1.4000E+0, 2.0000E+0, 2.0000E+0, 1.4000E+0, 1.0000E+0,
              1.0000E+0, 1.4000E+0, 1.4000E+0, 1.0000E+0, 2.0000E+0, 1.4000E+0,
              1.4000E+0, 2.0000E+0, 2.0000E+0, 1.0000E+0, 2.0000E+0, 1.0000E+0,
              2.0000E+0, 2.0000E+0, 1.0000E+0, 1.4000E+0, 2.0000E+0, 1.4000E+0,
              1.0000E+0, 1.0000E+0, 1.0000E+0, 1.4000E+0, 2.0000E+0, 1.4000E+0,
              1.4000E+0, 2.0000E+0, 1.4000E+0, 2.0000E+0, 1.4000E+0, 1.0000E+0,
              2.0000E+0, 1.0000E+0)

        kr = (1.0000E+0, 1.0000E+0, 8.5000E-1, 1.0000E+0, 8.5000E-1, 8.5000E-1,
              8.5000E-1, 8.5000E-1, 8.5000E-1, 7.0000E-1, 1.0000E+0, 8.5000E-1,
              1.0000E+0, 8.5000E-1, 8.5000E-1, 7.0000E-1, 8.5000E-1, 8.5000E-1,
              1.0000E+0, 8.5000E-1, 1.0000E+0, 8.5000E-1, 7.0000E-1, 1.0000E+0,
              1.0000E+0, 7.0000E-1, 8.5000E-1, 8.5000E-1, 8.5000E-1, 8.5000E-1,
              7.0000E-1, 8.5000E-1, 8.5000E-1, 8.5000E-1, 8.5000E-1, 7.0000E-1,
              8.5000E-1, 1.0000E+0, 7.0000E-1, 7.0000E-1, 7.0000E-1, 1.0000E+0,
              8.5000E-1, 7.0000E-1, 1.0000E+0, 1.0000E+0, 8.5000E-1, 1.0000E+0,
              8.5000E-1, 8.5000E-1, 1.0000E+0, 7.0000E-1, 7.0000E-1, 7.0000E-1,
              1.0000E+0, 1.0000E+0, 8.5000E-1, 1.0000E+0, 8.5000E-1, 8.5000E-1,
              1.0000E+0, 1.0000E+0, 7.0000E-1, 8.5000E-1, 1.0000E+0, 8.5000E-1,
              7.0000E-1, 1.0000E+0, 8.5000E-1, 7.0000E-1, 8.5000E-1, 7.0000E-1,
              7.0000E-1, 7.0000E-1, 1.0000E+0, 1.0000E+0, 1.0000E+0, 1.0000E+0,
              1.0000E+0, 1.0000E+0)

        le = (2.26526E+0, 1.70980E+1, 4.14690E+0, 1.77907E+1, 7.69293E+0,
              8.61758E+0, 6.79017E+0, 5.81725E+0, 1.71958E+0, 6.93692E+0,
              9.53414E-1, 3.17628E+0, 1.79935E+1, 7.66528E+0, 7.80370E+0,
              8.96364E+0, 9.98113E+0, 9.84343E+0, 5.97008E+0, 5.86676E+0,
              1.50746E+1, 9.02815E+0, 1.14268E+0, 3.41592E-1, 5.97192E+0,
              1.02805E+0, 9.09087E+0, 5.89787E+0, 8.07186E+0, 3.47383E+0,
              1.82278E-1, 8.04877E+0, 3.48810E+0, 5.12031E+0, 9.62704E+0,
              8.03494E+0, 3.82922E+0, 4.76266E+0, 4.24323E-1, 4.04893E+0,
              2.87782E+0, 2.73999E+0, 2.58863E+0, 8.37801E+0, 5.48520E+0,
              1.77907E+1, 7.69293E+0, 4.97596E+0, 4.06291E+0, 1.02939E+0,
              6.93692E+0, 6.67390E-1, 3.48667E+0, 8.81682E+0, 6.21833E+0,
              1.82556E+1, 9.98113E+0, 5.67292E+0, 1.01491E+1, 4.19054E+0,
              1.50746E+1, 2.01207E+0, 2.39114E-1, 7.10659E+0, 2.09806E+0,
              6.36361E+0, 4.85707E+0, 4.69655E+0, 1.69031E+0, 2.55189E-1,
              4.98300E+0, 5.84167E+0, 7.82210E+0, 1.14785E+1, 6.30695E+0,
              4.64873E+0, 6.06176E-1, 4.13156E+0, 1.60510E+1, 2.73999E+0)

        for Si, li, kti, kli, kri, lei in zip(Section, l, kt, kl, kr, le):

            le_calc = S5.s5_6_3_l_e(kti, kli, kri, li)

            self.assertAlmostEqual(first=le_calc, second=lei,
                                   delta=lei / Test_UT_S5.delta_p)

    def test_s5_6_1_Mb(self):
        """
        Test the s5_6_1_Mb method against values calculated in Excel.
        """

        Section = ('45x45x3EA', '150x150x12EA', '310UC137', '75x50x8UA',
                   '700WB173', '800WB168', '400WC181', '200x200x26EA',
                   '310UB40.4', '310UC158', '40x40x6EA', '1200WB342',
                   '180UB18.1', '500WC267', '200UBP146', '65x65x8EA',
                   '250UBP62.6', '25x25x5EA', '300PFC', '350WC280', '310UC118',
                   '125x125x12EA', '125x75x12UA', '250UB25.7', '250UBP84.9',
                   '100x100x12EA', '65x50x8UA', '150PFC', '200PFC', '250UC72.9',
                   '310UC96.8', '400WC144', '45x45x5EA', '400WC328', '610UB125',
                   '75x75x10EA', '200UB18.2', '200x200x20EA', '65x50x5UA',
                   '800WB122', '75x50x5UA', '100x100x8EA', '125TFB',
                   '1200WB455', '310UB46.2', '75x75x6EA')

        αs = (2.60634E-01, 5.78325E-01, 7.66640E-01, 3.89961E-01, 4.72346E-01,
              8.19764E-01, 9.53518E-01, 7.95673E-01, 8.95473E-01, 1.03374E+00,
              4.96810E-01, 9.14632E-01, 1.30520E-01, 1.01236E+00, 7.11100E-01,
              5.06828E-01, 9.15833E-01, 4.58986E-01, 2.25644E-01, 9.72035E-01,
              1.02580E+00, 4.49544E-01, 4.71391E-01, 3.08530E-01, 5.96690E-01,
              5.50490E-01, 3.24491E-01, 6.73818E-01, 2.46721E-01, 6.96445E-01,
              9.90475E-01, 1.01631E+00, 2.67530E-01, 1.03294E+00, 3.39203E-01,
              5.71637E-01, 1.11012E-01, 8.41374E-01, 2.00390E-01, 8.09823E-01,
              2.98472E-01, 2.90993E-01, 5.91268E-01, 7.31892E-01, 7.87018E-01,
              4.42550E-01)

        αm = (1.18518E+00, 1.27622E+00, 2.50000E+00, 1.38878E+00, 1.36323E+00,
              1.21823E+00, 1.18200E+00, 1.31280E+00, 1.11879E+00, 1.38300E+00,
              1.23594E+00, 2.36334E+00, 1.14069E+00, 1.20478E+00, 1.18923E+00,
              1.20980E+00, 1.29163E+00, 1.42896E+00, 1.22991E+00, 1.60601E+00,
              1.08768E+00, 1.37789E+00, 1.13809E+00, 1.47757E+00, 1.15213E+00,
              1.68467E+00, 1.56289E+00, 1.47017E+00, 1.09344E+00, 1.52289E+00,
              1.97015E+00, 1.46570E+00, 1.47872E+00, 2.50000E+00, 1.44836E+00,
              1.25411E+00, 1.16641E+00, 1.16430E+00, 1.66167E+00, 1.17315E+00,
              1.87065E+00, 1.36229E+00, 1.22988E+00, 1.39793E+00, 1.24655E+00,
              1.52809E+00)

        Ms = (1.02080E+03, 4.65000E+04, 6.44000E+05, 5.44000E+03, 1.78920E+06,
              1.91520E+06, 1.02300E+06, 1.68560E+05, 2.02560E+05, 7.50400E+05,
              1.69280E+03, 5.54400E+06, 5.02400E+04, 1.87600E+06, 4.76000E+05,
              6.14400E+03, 2.39040E+05, 4.70400E+02, 1.91760E+05, 1.77840E+06,
              6.63000E+05, 3.70600E+04, 2.29840E+04, 1.14840E+05, 3.63800E+05,
              2.37660E+04, 5.07600E+03, 4.64400E+04, 7.51400E+04, 3.32180E+05,
              5.27000E+05, 9.15800E+05, 1.91520E+03, 2.55600E+06, 1.25120E+06,
              1.09800E+04, 6.48000E+04, 1.59460E+05, 2.73240E+03, 1.64920E+06,
              3.11760E+03, 1.54440E+04, 2.89080E+04, 1.01160E+07, 2.47860E+05,
              6.62400E+03)

        Mb = (3.15323E+02, 3.43201E+04, 1.23429E+06, 2.94613E+03, 1.15209E+06,
              1.91264E+06, 1.15298E+06, 1.76071E+05, 2.02933E+05, 1.07282E+06,
              1.03943E+03, 1.19838E+07, 7.47989E+03, 2.28810E+06, 4.02535E+05,
              3.76726E+03, 2.82765E+05, 3.08524E+02, 5.32176E+04, 2.77627E+06,
              7.39734E+05, 2.29558E+04, 1.23306E+04, 5.23527E+04, 2.50099E+05,
              2.20405E+04, 2.57427E+03, 4.60046E+04, 2.02708E+04, 3.52313E+05,
              1.02838E+06, 1.36418E+06, 7.57658E+02, 6.60047E+06, 6.14697E+05,
              7.87148E+03, 8.39064E+03, 1.56208E+05, 9.09840E+02, 1.56681E+06,
              1.74067E+03, 6.12227E+03, 2.10215E+04, 1.03500E+07, 2.43165E+05,
              4.47952E+03)

        for Si, αsi, αmi, Msi, Mbi in zip(Section, αs, αm, Ms, Mb):

            Mb_calc = S5.s5_6_1_Mb(Msi, αmi, αsi)

            self.assertAlmostEqual(first=Mb_calc, second=Mbi,
                                   delta=Mbi / Test_UT_S5.delta_p,
                                   msg='Failure of the test for s5_6_1_Mb '
                                       + 'with Section: ' + Si)
